{"version":3,"sources":["webpack:///tree-chooser.min.js","webpack:///webpack/bootstrap 2e624f86be0e7cdc8aca?6551","webpack:///./src/index.js?9552","webpack:///external \"angular\"?11d2","webpack:///./src/treeChooser/index.js?b229","webpack:///./src/treeChooser/treeChooser.directive.js?c278","webpack:///./src/treeChooser/treeChooser.html?f178","webpack:///./src/treeChooser/treeChooser.controller.js?6835","webpack:///external {\"commonjs\":\"lodash\"}?ac96","webpack:///./src/treeChooserItem/index.js?b7cf","webpack:///./src/treeChooserItem/treeChooserItem.directive.js?c50f","webpack:///./src/treeChooserItem/treeChooserItem.html?6ddf","webpack:///./src/treeChooserItem/treeChooserItem.controller.js?4a9f","webpack:///./src/treeChooserItem/treeChooserItem.factory.js?f4e4"],"names":["exports","modules","__webpack_require__","moduleId","installedModules","module","id","loaded","call","m","c","p","angular","treeChooser","require","directive","controller","TreeChooser","$timeout","bindToController","controllerAs","scope","treeData","idProperty","labelProperty","childrenProperty","deselectsChildren","disableNode","filterNode","filterAutoShowLength","multiselect","ngDisabled","ngPlaceholder","onlyLeaves","restrictModel","selectsChildren","enablePills","modelAsId","disableClick","template","link","element","input","querySelector","on","event","stopPropagation","list","treeChooserDiv","addTabindex","this","vm","tabindex","removeTabindex","focusTreeChooserDiv","focus","focusInput","focusList","getListStyles","top","parentNode","offsetHeight","width","offsetWidth","scrollActive","active","scrollTop","offsetTop","$inject","TreeChooserController","$element","$scope","$window","TreeChooserItem","_","show","shown","next","addEventListener","closeFromClick","tryShow","$event","includes","get","relatedTarget","close","filterText","reset","clearActive","removeEventListener","$apply","forEach","itemsFlat","item","setActive","setExpanded","onListKeyDown","shouldStop","keyCode","toggleSelectedActive","prev","collapseActive","expandActive","preventDefault","onTextKeyDown","isEmpty","ngModel","$viewValue","isNil","removeFromModel","findActive","start","findIndex","isActive","find","index","isShowing","first","findLast","last","isTab","isSelected","toggleSelected","setSelected","selectChildren","getPresentChildren","child","deselectChildren","getChildren","value","isLeaf","addToModel","getItem","getPresentItems","filter","items","isPresent","isMatch","setExclusions","parentMatched","setExcluded","hasAChildPresent","showAll","resetActive","clearBranches","getModelAsItems","map","invoke","itemsIndex","compact","getId","push","$validate","$setViewValue","properties","remove","pop","syncModelToItems","debounce","model","$modelValue","toDelete","checkItem","isInitialLoad","createItems","flattenItems","flattenDeep","$onInit","label","children","isUndefined","isNumber","isFunction","toLower","stubFalse","$isEmpty","registerWatches","$watch","size","$watchCollection","keyBy","factory","TreeChooserItemController","chooserVm","TreeChooserItemFactory","parent","_this","excluded","expanded","selected","prototype","getLabel","isExpanded","toggleExpanded"],"mappings":"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","file":"tree-chooser.min.js","sourcesContent":["exports[\"tree-chooser\"] =\n/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar angular = __webpack_require__(1);\n\t\n\tvar treeChooser = angular.module('treeChooser', []);\n\t\n\t__webpack_require__(2)(treeChooser);\n\t__webpack_require__(11)(treeChooser);\n\t\n\tmodule.exports = treeChooser;\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports) {\n\n\tmodule.exports = require(\"angular\");\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tmodule.exports = function (treeChooser) {\n\t  treeChooser.directive('treeChooser', __webpack_require__(3)).controller('treeChooserController', __webpack_require__(9));\n\t};\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t/*@ngInject*/\n\t\n\tTreeChooser.$inject = ['$timeout'];\n\tfunction TreeChooser($timeout) {\n\t  __webpack_require__(4);\n\t\n\t  var angular = __webpack_require__(1);\n\t\n\t  return {\n\t    bindToController: true,\n\t    controller: 'treeChooserController',\n\t    controllerAs: 'vm',\n\t    require: ['ngModel'],\n\t    scope: {\n\t      /**\n\t       * Tree data structure\n\t       * @type {Array.<Object>}\n\t       */\n\t      treeData: '=treeChooser',\n\t\n\t      /**\n\t       * Property that contains unique ID\n\t       * @type {string}\n\t       */\n\t      idProperty: '@',\n\t\n\t      /**\n\t       * Property that contains label\n\t       * @todo alternately support template\n\t       * @type {string}\n\t       */\n\t      labelProperty: '@',\n\t\n\t      /**\n\t       * Property that contains children array\n\t       * @type {string}\n\t       */\n\t      childrenProperty: '@',\n\t\n\t      /**\n\t       * Deselect all descendants\n\t       * @type {boolean}\n\t       */\n\t      deselectsChildren: '=?',\n\t\n\t      /**\n\t       * Function to determine if item is disabled\n\t       * @type {Function}\n\t       */\n\t      disableNode: '=?',\n\t\n\t      /**\n\t       * Function to determine if item is filtered\n\t       * @type {Function}\n\t       */\n\t      filterNode: '=?',\n\t\n\t      /**\n\t       * Show list and expand all nodes after specified length\n\t       * @type {number}\n\t       */\n\t      filterAutoShowLength: '=?',\n\t\n\t      /**\n\t       * Enable multiselection\n\t       * @type {boolean}\n\t       */\n\t      multiselect: '=?',\n\t\n\t      /**\n\t       * ngDisabled pass through\n\t       * @type {boolean}\n\t       */\n\t      ngDisabled: '=?',\n\t\n\t      /**\n\t       * ngPlaceholder pass through\n\t       * @type {boolean}\n\t       */\n\t      ngPlaceholder: '=?',\n\t\n\t      /**\n\t       * Only allow selection of leaf nodes\n\t       * @type {boolean}\n\t       */\n\t      onlyLeaves: '=?',\n\t\n\t      /**\n\t       * Restrict model to members of tree data structure\n\t       * @type {boolean}\n\t       */\n\t      restrictModel: '=?',\n\t\n\t      /**\n\t       * Select all descendants\n\t       * @type {boolean}\n\t       */\n\t      selectsChildren: '=?',\n\t\n\t      /**\n\t       * Enable pills\n\t       * @type {boolean}\n\t       */\n\t      enablePills: '=?',\n\t\n\t      /**\n\t       * Just use the ID as the model value?\n\t       * @type {boolean}\n\t       */\n\t      modelAsId: '=?',\n\t\n\t      /**\n\t       * Disable outside click to close\n\t       * @type {boolean}\n\t       */\n\t      disableClick: '=?'\n\t    },\n\t    template: __webpack_require__(8),\n\t    link: function link(scope, element) {\n\t      var input = angular.element(element[0].querySelector('.treeChooser-input input'));\n\t      input.on('click', function (event) {\n\t        event.stopPropagation();\n\t      });\n\t\n\t      var list = angular.element(element[0].querySelector('.treeChooser-list'));\n\t      list.on('click', function (event) {\n\t        event.stopPropagation();\n\t      });\n\t\n\t      var treeChooserDiv = angular.element(element[0].querySelector('.treeChooser'));\n\t      scope.addTabindex = function () {\n\t        this.vm.tabindex = '0';\n\t      };\n\t      scope.removeTabindex = function () {\n\t        this.vm.tabindex = '-1';\n\t      };\n\t      scope.focusTreeChooserDiv = function () {\n\t        scope.addTabindex();\n\t        $timeout(function () {\n\t          treeChooserDiv[0].focus();\n\t        });\n\t      };\n\t\n\t      scope.focusInput = function () {\n\t        $timeout(function () {\n\t          input[0].focus();\n\t        });\n\t      };\n\t\n\t      scope.focusList = function () {\n\t        $timeout(function () {\n\t          list[0].focus();\n\t        });\n\t      };\n\t\n\t      scope.getListStyles = function () {\n\t        return {\n\t          top: input[0].parentNode.offsetHeight + 'px',\n\t          width: input[0].parentNode.offsetWidth + 'px'\n\t        };\n\t      };\n\t\n\t      scope.scrollActive = function () {\n\t        $timeout(function () {\n\t          var active = element[0].querySelector('.treeChooser-active .treeChooser-label');\n\t          // If no results are shown, there won't be an active!\n\t          if (active) {\n\t            list[0].scrollTop = active.offsetTop;\n\t          }\n\t        });\n\t      };\n\t    }\n\t  };\n\t}\n\t\n\tmodule.exports = TreeChooser;\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 5 */,\n/* 6 */,\n/* 7 */,\n/* 8 */\n/***/ (function(module, exports) {\n\n\tmodule.exports = \"<div class=treeChooser ng-attr-tabindex={{vm.tabindex}}> <div class=treeChooser-input ng-class=\\\"{'treeChooser-input-focused': vm.focused}\\\"> <span ng-if=vm.enablePills ng-click=\\\"vm.removeFromModel(item); focusInput();\\\" ng-repeat=\\\"item in vm.getModelAsItems()\\\"> {{item[vm.properties.label]}} </span> <input type=text ng-disabled=vm.ngDisabled ng-model=vm.filterText ng-keydown=vm.onTextKeyDown($event) ng-focus=\\\"vm.focused = true; vm.tryShow($event);\\\" ng-blur=\\\"vm.focused = false\\\" placeholder={{vm.ngPlaceholder}}> </div> <ul ng-show=vm.shown ng-keydown=vm.onListKeyDown($event) ng-style=getListStyles() class=treeChooser-list tabindex=-1> <li ng-repeat=\\\"item in vm.getPresentItems()\\\" tree-chooser-item=item></li> <li ng-if=!vm.getPresentItems().length>No match</li> </ul> </div> \";\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t/*@ngInject*/\n\t\n\tTreeChooserController.$inject = ['$element', '$scope', '$timeout', '$window', 'TreeChooserItem'];\n\tfunction TreeChooserController($element, $scope, $timeout, $window, TreeChooserItem) {\n\t  var vm = this,\n\t      _ = __webpack_require__(10);\n\t\n\t  // @todo create a separate directive for the list\n\t\n\t  /**\n\t   * Show the search results, add outside click handler\n\t   */\n\t  vm.show = function () {\n\t    if (vm.shown) {\n\t      return;\n\t    }\n\t\n\t    vm.shown = true;\n\t\n\t    vm.next();\n\t\n\t    // Add event listener to determine when user clicks outside of tree chooser\n\t    if (!vm.disableClick) {\n\t      $timeout(function () {\n\t        $window.addEventListener('click', vm.closeFromClick);\n\t      });\n\t    }\n\t  };\n\t\n\t  /**\n\t   * Show on focus, unless returning from the list\n\t   * @param {Event} $event\n\t   */\n\t  vm.tryShow = function ($event) {\n\t    if (_.includes(_.get($event.relatedTarget, 'className'), 'treeChooser-list')) {\n\t      return;\n\t    }\n\t    vm.show();\n\t  };\n\t\n\t  /**\n\t   * Close the search results, remove outside click handler\n\t   */\n\t  vm.close = function () {\n\t    vm.filterText = '';\n\t    vm.reset();\n\t    vm.shown = false;\n\t    vm.clearActive();\n\t    if (!vm.disableClick) {\n\t      $window.removeEventListener('click', vm.closeFromClick);\n\t    }\n\t  };\n\t\n\t  /**\n\t   * Close on outside click\n\t   */\n\t  vm.closeFromClick = function () {\n\t    vm.close();\n\t    $scope.$apply();\n\t  };\n\t\n\t  /**\n\t   * Reset the collapsed and active state\n\t   */\n\t  vm.reset = function () {\n\t    _.forEach(vm.itemsFlat, function (item) {\n\t      item.setActive(false);\n\t      item.setExpanded(false);\n\t    });\n\t  };\n\t\n\t  /**\n\t   * Handle results keyboard navigation\n\t   * @param {Object} $event\n\t   */\n\t  vm.onListKeyDown = function ($event) {\n\t    var shouldStop = false;\n\t\n\t    switch ($event.keyCode) {\n\t      case 27:\n\t        //Escape\n\t        shouldStop = true;\n\t        vm.close();\n\t        $scope.focusInput();\n\t        break;\n\t      case 13:\n\t        //Enter\n\t        shouldStop = true;\n\t        vm.toggleSelectedActive();\n\t        vm.close();\n\t        $scope.focusInput();\n\t        break;\n\t      case 40:\n\t        //Down Arrow\n\t        shouldStop = true;\n\t        vm.next();\n\t        break;\n\t      case 38:\n\t        //Up Arrow\n\t        shouldStop = true;\n\t        vm.prev();\n\t        break;\n\t      case 37:\n\t        //Left Arrow\n\t        shouldStop = true;\n\t        vm.collapseActive();\n\t        break;\n\t      case 39:\n\t        //Right Arrow\n\t        shouldStop = true;\n\t        vm.expandActive();\n\t        break;\n\t      case 32:\n\t        //Space\n\t        shouldStop = true;\n\t        vm.toggleSelectedActive();\n\t        break;\n\t      case 9:\n\t        //Tab\n\t        vm.toggleSelectedActive(true);\n\t        vm.close();\n\t        break;\n\t    }\n\t\n\t    if (shouldStop) {\n\t      $event.preventDefault();\n\t      $event.stopPropagation();\n\t    }\n\t  };\n\t\n\t  /**\n\t   * Handle input keyboard navigation\n\t   * @param {Object} $event\n\t   */\n\t  vm.onTextKeyDown = function ($event) {\n\t    switch ($event.keyCode) {\n\t      case 27:\n\t        //Escape\n\t        vm.close();\n\t        break;\n\t      case 13:\n\t        //Enter\n\t        if (vm.shown) {\n\t          vm.toggleSelectedActive();\n\t        } else {\n\t          vm.show($event);\n\t        }\n\t        break;\n\t      case 40:\n\t        //Down Arrow\n\t        vm.show($event);\n\t        $scope.focusList();\n\t        break;\n\t      case 8:\n\t        //Backspace\n\t        if (_.isEmpty(vm.filterText) && (vm.multiselect ? !_.isEmpty(vm.ngModel.$viewValue) : !_.isNil(vm.ngModel.$viewValue))) {\n\t          vm.removeFromModel();\n\t        }\n\t        break;\n\t      case 9:\n\t        //Tab\n\t        vm.toggleSelectedActive(true);\n\t        vm.close();\n\t        break;\n\t    }\n\t  };\n\t\n\t  /**\n\t   * Find next visible item\n\t   */\n\t  vm.next = function () {\n\t    if (_.isEmpty(vm.itemsFlat)) {\n\t      return;\n\t    }\n\t\n\t    var active = vm.findActive();\n\t\n\t    if (!active) {\n\t      var first = _.find(vm.itemsFlat, function (item) {\n\t        return item.isShowing();\n\t      });\n\t      // If no results are shown, there's nothing to set first!\n\t      if (first) {\n\t        first.setActive(true);\n\t      }\n\t    } else {\n\t      var start = _.findIndex(vm.itemsFlat, function (item) {\n\t        return item.isActive();\n\t      });\n\t      active.setActive(false);\n\t\n\t      // @todo optimize array traversal\n\t      var next = _.find(vm.itemsFlat, function (item, index) {\n\t        return index > start && item.isShowing();\n\t      });\n\t      if (!next) {\n\t        next = _.find(vm.itemsFlat, function (item, index) {\n\t          return index < start && item.isShowing();\n\t        });\n\t      }\n\t      if (next) {\n\t        next.setActive(true);\n\t      }\n\t    }\n\t\n\t    $scope.scrollActive();\n\t  };\n\t\n\t  /**\n\t   * Find previous visible item\n\t   */\n\t  vm.prev = function () {\n\t    var active = vm.findActive();\n\t\n\t    if (!active) {\n\t      var last = _.findLast(vm.itemsFlat, function (item) {\n\t        return item.isShowing();\n\t      });\n\t      // If no results are shown, there's nothing to set last!\n\t      if (last) {\n\t        last.setActive(true);\n\t      }\n\t    } else {\n\t      var start = _.findIndex(vm.itemsFlat, function (item) {\n\t        return item.isActive();\n\t      });\n\t      active.setActive(false);\n\t\n\t      // @todo optimize array traversal\n\t      var prev = _.findLast(vm.itemsFlat, function (item, index) {\n\t        return index < start && item.isShowing();\n\t      });\n\t      if (!prev) {\n\t        prev = _.findLast(vm.itemsFlat, function (item, index) {\n\t          return index > start && item.isShowing();\n\t        });\n\t      }\n\t      if (prev) {\n\t        prev.setActive(true);\n\t      }\n\t    }\n\t\n\t    $scope.scrollActive();\n\t  };\n\t\n\t  /**\n\t   * Expand active item\n\t   */\n\t  vm.expandActive = function () {\n\t    var active = vm.findActive();\n\t    if (active) {\n\t      active.setExpanded(true);\n\t    }\n\t  };\n\t\n\t  /**\n\t   * Collapse active item\n\t   */\n\t  vm.collapseActive = function () {\n\t    var active = vm.findActive();\n\t    if (active) {\n\t      active.setExpanded(false);\n\t    }\n\t  };\n\t\n\t  /**\n\t   * Set all items inactive\n\t   */\n\t  vm.clearActive = function () {\n\t    _.forEach(vm.itemsFlat, function (item) {\n\t      item.setActive(false);\n\t    });\n\t  };\n\t\n\t  /**\n\t   * Toggle selection on active item\n\t   * @param {boolean} [isTab]\n\t   */\n\t  vm.toggleSelectedActive = function (isTab) {\n\t    var active = vm.findActive();\n\t    if (active) {\n\t      // Don't unselect on tab\n\t      if (isTab && active.isSelected()) {\n\t        return;\n\t      }\n\t      vm.toggleSelected(active);\n\t    }\n\t  };\n\t\n\t  /**\n\t   * Get the active item\n\t   */\n\t  vm.findActive = function () {\n\t    return _.find(vm.itemsFlat, function (item) {\n\t      return item.isActive();\n\t    });\n\t  };\n\t\n\t  /**\n\t   * Toggle selected unless disabled\n\t   */\n\t  vm.toggleSelected = function (item) {\n\t    if (vm.disableNode(item)) {\n\t      return;\n\t    }\n\t\n\t    vm.setSelected(item, !item.isSelected());\n\t    if (item.isSelected() && !vm.multiselect) {\n\t      vm.close();\n\t    }\n\t  };\n\t\n\t  /**\n\t   * Select all unfiltered children\n\t   */\n\t  vm.selectChildren = function (item) {\n\t    _.forEach(item.getPresentChildren(), function (child) {\n\t      if (!child.isSelected()) {\n\t        vm.setSelected(child, true);\n\t      }\n\t      vm.selectChildren(child);\n\t    });\n\t  };\n\t\n\t  /**\n\t   * Deselect all children\n\t   */\n\t  vm.deselectChildren = function (item) {\n\t    _.forEach(item.getChildren(), function (child) {\n\t      if (child.isSelected()) {\n\t        vm.setSelected(child, false);\n\t      }\n\t      vm.deselectChildren(child);\n\t    });\n\t  };\n\t\n\t  /**\n\t   * Set selection state\n\t   */\n\t  vm.setSelected = function (item, value) {\n\t    // Enforce leaf only restrictions if necessary\n\t    if (value && vm.onlyLeaves && !item.isLeaf()) {\n\t      value = false;\n\t    }\n\t    item.setSelected(value);\n\t    if (value) {\n\t      vm.addToModel(item);\n\t      if (vm.selectsChildren && vm.multiselect) {\n\t        vm.selectChildren(item);\n\t      } else if (!vm.selectsChildren && !vm.multiselect) {\n\t        $scope.focusTreeChooserDiv();\n\t      }\n\t    } else {\n\t      vm.removeFromModel(item.getItem());\n\t      if (vm.deselectsChildren && vm.multiselect) {\n\t        vm.deselectChildren(item);\n\t      }\n\t    }\n\t  };\n\t\n\t  /**\n\t   * Get top level present items\n\t   */\n\t  vm.getPresentItems = function () {\n\t    return _.filter(vm.items, function (item) {\n\t      return item.isPresent();\n\t    });\n\t  };\n\t\n\t  /**\n\t   * Determine if visible or not\n\t   * @todo isMatch, isPresent, isExcluded, etc all needs to better naming\n\t   */\n\t  vm.isMatch = function (item) {\n\t    if (!vm.filterText) {\n\t      return true;\n\t    }\n\t    return vm.filterNode(item.getItem(), vm.filterText);\n\t  };\n\t\n\t  /**\n\t   * Recursively set exclusions so that parents of included children aren't hidden\n\t   * @param {Array} items\n\t   * @param {boolean} parentMatched\n\t   */\n\t  vm.setExclusions = function (items, parentMatched) {\n\t    _.forEach(items, function (item) {\n\t      vm.setExclusions(item.getChildren(), parentMatched || vm.isMatch(item));\n\t      item.setExcluded(!vm.isMatch(item) && !item.hasAChildPresent() && !parentMatched);\n\t    });\n\t  };\n\t\n\t  /**\n\t   * Recursively set exclusions so that parents of included children aren't hidden\n\t   */\n\t  vm.showAll = function () {\n\t    _(vm.itemsFlat).filter(function (item) {\n\t      return item.isPresent();\n\t    }).forEach(function (item) {\n\t      item.setExpanded(true);\n\t    });\n\t\n\t    vm.show();\n\t  };\n\t\n\t  /**\n\t   * Set active property to false if active item exists\n\t   */\n\t  vm.resetActive = function () {\n\t    var active = vm.findActive();\n\t    if (active) {\n\t      active.setActive(false);\n\t    }\n\t  };\n\t\n\t  /**\n\t   * Clear all no leaves\n\t   * @todo if deselect Children is enabled, won't this deselect leaves?\n\t   */\n\t  vm.clearBranches = function () {\n\t    _.forEach(vm.itemsFlat, function (item) {\n\t      if (!item.isLeaf() && item.isSelected()) {\n\t        vm.setSelected(item, false);\n\t      }\n\t    });\n\t  };\n\t\n\t  /**\n\t   * Get model as items because it could be saved as id\n\t   */\n\t  vm.getModelAsItems = function () {\n\t    return _(vm.multiselect ? vm.ngModel.$viewValue : [vm.ngModel.$viewValue]).map(function (item) {\n\t      // Can' guarantee the item still exists unless restrict model is on\n\t      return vm.modelAsId ? _.invoke(vm.itemsIndex[item], 'getItem') : item;\n\t    }).compact().value();\n\t  };\n\t\n\t  /**\n\t   * Add item to model and trigger validation\n\t   */\n\t  vm.addToModel = function (item) {\n\t    var value = vm.modelAsId ? item.getId() : item.getItem();\n\t    if (vm.multiselect) {\n\t      vm.ngModel.$viewValue.push(value);\n\t      vm.ngModel.$validate();\n\t    } else {\n\t      vm.ngModel.$setViewValue(value);\n\t    }\n\t  };\n\t\n\t  /**\n\t   * Remove item from model and trigger validation\n\t   */\n\t  vm.removeFromModel = function (item) {\n\t    if (!vm.multiselect) {\n\t      vm.ngModel.$setViewValue(null);\n\t      $scope.removeTabindex();\n\t    } else {\n\t      if (item) {\n\t        var id = _.get(item, vm.properties.id);\n\t        _.remove(vm.ngModel.$viewValue, function (item) {\n\t          return vm.modelAsId ? item === id : _.get(item, vm.properties.id) === id;\n\t        });\n\t      } else {\n\t        vm.ngModel.$viewValue.pop();\n\t      }\n\t      vm.ngModel.$validate();\n\t    }\n\t  };\n\t\n\t  /**\n\t   * Sync model to items in case model, items or restrictModel changes\n\t   */\n\t  vm.syncModelToItems = _.debounce(function () {\n\t    _.forEach(vm.itemsFlat, function (item) {\n\t      item.setSelected(false);\n\t    });\n\t\n\t    var model = vm.multiselect ? vm.ngModel.$modelValue : [vm.ngModel.$modelValue];\n\t\n\t    var toDelete = [];\n\t    // Set selected items back to true\n\t    _.forEach(model, function (item) {\n\t      var id = vm.modelAsId ? item : _.get(item, vm.properties.id);\n\t      var checkItem = vm.itemsIndex[id];\n\t      if (checkItem) {\n\t        checkItem.setSelected(true);\n\t        if (vm.isInitialLoad) {\n\t          vm.isInitialLoad = false;\n\t          if (!vm.selectsChildren && !vm.multiselect) {\n\t            $scope.addTabindex();\n\t          }\n\t        }\n\t      } else if (vm.restrictModel) {\n\t        toDelete.push(item);\n\t      }\n\t    });\n\t\n\t    _.forEach(toDelete, function (item) {\n\t      vm.removeFromModel(item);\n\t    });\n\t\n\t    // This is debounced, so ensure scope is applied!\n\t    $scope.$apply();\n\t  });\n\t\n\t  /**\n\t   * Create TreeChooserItem hierarchy\n\t   */\n\t  vm.createItems = function (items) {\n\t    return _.map(items, function (item) {\n\t      return new TreeChooserItem(item, null, vm.properties);\n\t    });\n\t  };\n\t\n\t  /**\n\t   * Flatten hierarchy for more efficient processing\n\t   */\n\t  vm.flattenItems = function (items) {\n\t    return _(items).map(function (item) {\n\t      return [item, vm.flattenItems(item.getChildren())];\n\t    }).flattenDeep().value();\n\t  };\n\t\n\t  /**\n\t   * Set the active element on search\n\t   */\n\t  vm.setActive = function () {\n\t    vm.resetActive();\n\t    var first;\n\t    if (vm.onlyLeaves) {\n\t      // Find first present leaf in flat items\n\t      first = _.find(vm.itemsFlat, function (item) {\n\t        return item.isLeaf() && item.isPresent();\n\t      });\n\t    } else {\n\t      // Find first present branch, at least one branch will be present in items\n\t      first = _.find(vm.items, function (item) {\n\t        return item.isPresent();\n\t      });\n\t    }\n\t\n\t    if (first) {\n\t      first.setActive(true);\n\t    }\n\t  };\n\t\n\t  this.$onInit = function () {\n\t    // Flag to determine whether search results are showing\n\t    vm.shown = false;\n\t\n\t    // flag indicating that this is the initial load\n\t    vm.isInitialLoad = true;\n\t\n\t    // default .treeChooser tabindex value\n\t    vm.tabindex = '-1';\n\t\n\t    // Properties use to access special parts of item\n\t    vm.properties = {\n\t      id: vm.idProperty || 'id',\n\t      label: vm.labelProperty || 'label',\n\t      children: vm.childrenProperty || 'children'\n\t    };\n\t\n\t    // Enable multiselect by default\n\t    if (_.isUndefined(vm.multiselect)) {\n\t      vm.multiselect = true;\n\t    }\n\t    // Disable only leaves by default\n\t    if (_.isUndefined(vm.onlyLeaves)) {\n\t      vm.onlyLeaves = false;\n\t    }\n\t    // Disable selects children by default\n\t    if (_.isUndefined(vm.selectsChildren)) {\n\t      vm.selectsChildren = false;\n\t    }\n\t    // Disable deselects children by default\n\t    if (_.isUndefined(vm.deselectsChildren)) {\n\t      vm.deselectsChildren = false;\n\t    }\n\t    // Disable restrict model by default\n\t    if (_.isUndefined(vm.restrictModel)) {\n\t      vm.restrictModel = false;\n\t    }\n\t    // Enable pills by default\n\t    if (_.isUndefined(vm.enablePills)) {\n\t      vm.enablePills = true;\n\t    }\n\t    // Save ID to model by default\n\t    if (_.isUndefined(vm.modelAsId)) {\n\t      vm.modelAsId = true;\n\t    }\n\t    // Auto show after specified filter text length\n\t    if (!_.isNumber(vm.filterAutoShowLength)) {\n\t      vm.filterAutoShowLength = 2;\n\t    }\n\t    // Default filter node function\n\t    if (!_.isFunction(vm.filterNode)) {\n\t      vm.filterNode = function (item, filterText) {\n\t        return _.includes(_.toLower(_.get(item, vm.properties.label)), _.toLower(filterText));\n\t      };\n\t    }\n\t    // Default disable node function\n\t    if (!_.isFunction(vm.disableNode)) {\n\t      vm.disableNode = _.stubFalse;\n\t    }\n\t    // Default to enable close to click\n\t    if (!_.isUndefined(vm.disableClick)) {\n\t      vm.disableClick = false;\n\t    }\n\t\n\t    // Get access to ngModel\n\t    vm.ngModel = $element.controller('ngModel');\n\t    // And override $isEmpty to account for array emptiness if multiselect\n\t    if (vm.multiselect) {\n\t      vm.ngModel.$isEmpty = _.isEmpty;\n\t    }\n\t\n\t    this.registerWatches();\n\t  };\n\t\n\t  this.registerWatches = function () {\n\t    /**\n\t     * Update exclusions on filter text change\n\t     */\n\t    $scope.$watch('vm.filterText', function () {\n\t      vm.setExclusions(vm.items);\n\t      if (_.size(vm.filterText) >= vm.filterAutoShowLength) {\n\t        vm.showAll();\n\t        vm.setActive();\n\t      } else {\n\t        vm.reset();\n\t      }\n\t    });\n\t\n\t    /**\n\t     * Sync on model change\n\t     */\n\t    $scope.$watchCollection('vm.ngModel.$modelValue', function () {\n\t      vm.syncModelToItems();\n\t    });\n\t\n\t    /**\n\t     * Sync on items change\n\t     */\n\t    $scope.$watch('vm.treeData', function () {\n\t      // @todo is this manual GC needed?\n\t      _.forEach(vm.itemsFlat, function (item, index) {\n\t        delete vm.itemsFlat[index];\n\t      });\n\t\n\t      // Create chooser items, so the underlying model is not touched\n\t      vm.items = vm.createItems(vm.treeData);\n\t      // Flatten into a sorted list for easier navigation\n\t      vm.itemsFlat = vm.flattenItems(vm.items);\n\t      // Item index\n\t      vm.itemsIndex = _.keyBy(vm.itemsFlat, function (item) {\n\t        return item.getId();\n\t      });\n\t\n\t      vm.syncModelToItems();\n\t    });\n\t\n\t    /**\n\t     * Sync on restrict model\n\t     */\n\t    $scope.$watch('vm.restrictModel', function (value) {\n\t      if (value) {\n\t        vm.syncModelToItems();\n\t      }\n\t    });\n\t\n\t    /**\n\t     * Deselect branches on only leaves true\n\t     */\n\t    $scope.$watch('vm.onlyLeaves', function (value) {\n\t      if (value) {\n\t        vm.clearBranches();\n\t      }\n\t    });\n\t\n\t    /**\n\t     * Disable results on disable\n\t     */\n\t    $scope.$watch('vm.ngDisabled', function (value) {\n\t      if (value) {\n\t        vm.close();\n\t      }\n\t    });\n\t  };\n\t}\n\t\n\tmodule.exports = TreeChooserController;\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports) {\n\n\tmodule.exports = require(\"lodash\");\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tmodule.exports = function (treeChooser) {\n\t  treeChooser.directive('treeChooserItem', __webpack_require__(12)).controller('treeChooserItemController', __webpack_require__(14)).factory('TreeChooserItem', __webpack_require__(15));\n\t};\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tfunction TreeChooserItem() {\n\t  return {\n\t    bindToController: true,\n\t    controller: 'treeChooserItemController',\n\t    controllerAs: 'vm',\n\t    require: '^treeChooser',\n\t    scope: {\n\t      item: '=treeChooserItem'\n\t    },\n\t    template: __webpack_require__(13)\n\t  };\n\t}\n\t\n\tmodule.exports = TreeChooserItem;\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports) {\n\n\tmodule.exports = \"<span class=treeChooser-item ng-class=\\\"{'treeChooser-selected': vm.item.isSelected(), 'treeChooser-active': vm.item.isActive()}\\\"> <span class=treeChooser-expansion ng-click=\\\"vm.chooserVm.clearActive(); vm.item.setActive(true); vm.item.toggleExpanded()\\\"> <span ng-show=\\\"vm.item.hasAChildPresent() && vm.item.isExpanded()\\\" class=treeChooser-expanded>-</span> <span ng-show=\\\"vm.item.hasAChildPresent() && !vm.item.isExpanded()\\\" class=treeChooser-collapsed>+</span> </span> <span class=treeChooser-label ng-class=\\\"{'treeChooser-disabled': vm.chooserVm.disableNode(vm.item)}\\\" ng-click=\\\"vm.chooserVm.clearActive(); vm.item.setActive(true); vm.chooserVm.toggleSelected(vm.item)\\\"> {{vm.item.getLabel()}} </span> <ul ng-if=vm.item.isExpanded()> <li ng-repeat=\\\"item in vm.item.getPresentChildren()\\\" tree-chooser-item=item></li> </ul> </span> \";\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*@ngInject*/\n\t\n\tTreeChooserItemController.$inject = ['$element'];\n\tfunction TreeChooserItemController($element) {\n\t  var vm = this;\n\t  vm.chooserVm = $element.controller('treeChooser');\n\t}\n\t\n\tmodule.exports = TreeChooserItemController;\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tfunction TreeChooserItemFactory() {\n\t  var _ = __webpack_require__(10);\n\t\n\t  function TreeChooserItem(item, parent, properties) {\n\t    var _this = this;\n\t\n\t    this.item = item; // @todo use this for templates\n\t\n\t    this.properties = properties;\n\t    this.id = _.get(this.item, this.properties.id);\n\t    this.label = _.get(this.item, this.properties.label);\n\t\n\t    this.parent = parent;\n\t\n\t    this.active = false;\n\t    this.excluded = false;\n\t    this.expanded = false;\n\t    this.selected = false;\n\t\n\t    var children = _.get(item, properties.children);\n\t    this.children = _.map(children, function (child) {\n\t      return new TreeChooserItem(child, _this, properties);\n\t    });\n\t  }\n\t\n\t  TreeChooserItem.prototype.getItem = function () {\n\t    return this.item;\n\t  };\n\t\n\t  TreeChooserItem.prototype.getChildren = function () {\n\t    return this.children;\n\t  };\n\t\n\t  TreeChooserItem.prototype.hasAChildPresent = function () {\n\t    return !!_.find(this.getChildren(), function (child) {\n\t      return child.isPresent();\n\t    });\n\t  };\n\t\n\t  TreeChooserItem.prototype.getPresentChildren = function () {\n\t    return _.filter(this.getChildren(), function (child) {\n\t      return child.isPresent();\n\t    });\n\t  };\n\t\n\t  TreeChooserItem.prototype.getId = function () {\n\t    return this.id;\n\t  };\n\t\n\t  TreeChooserItem.prototype.getLabel = function () {\n\t    return this.label;\n\t  };\n\t\n\t  TreeChooserItem.prototype.isActive = function () {\n\t    return this.active;\n\t  };\n\t\n\t  TreeChooserItem.prototype.isLeaf = function () {\n\t    return _.isEmpty(this.children);\n\t  };\n\t\n\t  TreeChooserItem.prototype.isShowing = function () {\n\t    return this.isPresent() && (!this.parent || this.parent.isExpanded());\n\t  };\n\t\n\t  TreeChooserItem.prototype.isPresent = function () {\n\t    return !this.excluded;\n\t  };\n\t\n\t  TreeChooserItem.prototype.isExpanded = function () {\n\t    return this.expanded;\n\t  };\n\t\n\t  TreeChooserItem.prototype.isSelected = function () {\n\t    return this.selected;\n\t  };\n\t\n\t  TreeChooserItem.prototype.setActive = function (value) {\n\t    this.active = value;\n\t  };\n\t\n\t  TreeChooserItem.prototype.setExcluded = function (value) {\n\t    this.excluded = value;\n\t  };\n\t\n\t  TreeChooserItem.prototype.setExpanded = function (value) {\n\t    this.expanded = value;\n\t  };\n\t\n\t  TreeChooserItem.prototype.setSelected = function (value) {\n\t    this.selected = value;\n\t  };\n\t\n\t  TreeChooserItem.prototype.toggleExpanded = function () {\n\t    this.expanded = !this.expanded;\n\t  };\n\t\n\t  return TreeChooserItem;\n\t}\n\t\n\tmodule.exports = TreeChooserItemFactory;\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// tree-chooser.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 2e624f86be0e7cdc8aca","var angular = require('angular');\n\nvar treeChooser = angular.module('treeChooser', []);\n\nrequire('./treeChooser')(treeChooser);\nrequire('./treeChooserItem')(treeChooser);\n\nmodule.exports = treeChooser;\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","module.exports = require(\"angular\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"angular\"\n// module id = 1\n// module chunks = 0 1","'use strict';\n\nmodule.exports = function (treeChooser) {\n  treeChooser\n    .directive('treeChooser', require('./treeChooser.directive'))\n    .controller('treeChooserController', require('./treeChooser.controller'));\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/treeChooser/index.js","'use strict';\n\n/*@ngInject*/\nfunction TreeChooser($timeout) {\n  require('./treeChooser.css');\n\n  var angular = require('angular');\n\n  return {\n    bindToController: true,\n    controller: 'treeChooserController',\n    controllerAs: 'vm',\n    require: ['ngModel'],\n    scope: {\n      /**\n       * Tree data structure\n       * @type {Array.<Object>}\n       */\n      treeData: '=treeChooser',\n\n      /**\n       * Property that contains unique ID\n       * @type {string}\n       */\n      idProperty: '@',\n\n      /**\n       * Property that contains label\n       * @todo alternately support template\n       * @type {string}\n       */\n      labelProperty: '@',\n\n      /**\n       * Property that contains children array\n       * @type {string}\n       */\n      childrenProperty: '@',\n\n      /**\n       * Deselect all descendants\n       * @type {boolean}\n       */\n      deselectsChildren: '=?',\n\n      /**\n       * Function to determine if item is disabled\n       * @type {Function}\n       */\n      disableNode: '=?',\n\n      /**\n       * Function to determine if item is filtered\n       * @type {Function}\n       */\n      filterNode: '=?',\n\n      /**\n       * Show list and expand all nodes after specified length\n       * @type {number}\n       */\n      filterAutoShowLength: '=?',\n\n      /**\n       * Enable multiselection\n       * @type {boolean}\n       */\n      multiselect: '=?',\n\n      /**\n       * ngDisabled pass through\n       * @type {boolean}\n       */\n      ngDisabled: '=?',\n\n      /**\n       * ngPlaceholder pass through\n       * @type {boolean}\n       */\n      ngPlaceholder: '=?',\n\n      /**\n       * Only allow selection of leaf nodes\n       * @type {boolean}\n       */\n      onlyLeaves: '=?',\n\n      /**\n       * Restrict model to members of tree data structure\n       * @type {boolean}\n       */\n      restrictModel: '=?',\n\n      /**\n       * Select all descendants\n       * @type {boolean}\n       */\n      selectsChildren: '=?',\n\n      /**\n       * Enable pills\n       * @type {boolean}\n       */\n      enablePills: '=?',\n\n      /**\n       * Just use the ID as the model value?\n       * @type {boolean}\n       */\n      modelAsId: '=?',\n\n      /**\n       * Disable outside click to close\n       * @type {boolean}\n       */\n      disableClick: '=?'\n    },\n    template: require('./treeChooser.html'),\n    link: function (scope, element) {\n      var input = angular.element(element[0].querySelector('.treeChooser-input input'));\n      input.on('click', function (event) {\n        event.stopPropagation();\n      });\n\n      var list = angular.element(element[0].querySelector('.treeChooser-list'));\n      list.on('click', function (event) {\n        event.stopPropagation();\n      });\n\n      var treeChooserDiv = angular.element(element[0].querySelector('.treeChooser'));\n      scope.addTabindex = function () {\n        this.vm.tabindex = '0';\n      };\n      scope.removeTabindex = function () {\n        this.vm.tabindex = '-1';\n      };\n      scope.focusTreeChooserDiv = function () {\n        scope.addTabindex();\n        $timeout(function () {\n          treeChooserDiv[0].focus();\n        });\n      };\n\n      scope.focusInput = function () {\n        $timeout(function () {\n          input[0].focus();\n        });\n      };\n\n      scope.focusList = function () {\n        $timeout(function () {\n          list[0].focus();\n        });\n      };\n\n      scope.getListStyles = function () {\n        return {\n          top: input[0].parentNode.offsetHeight + 'px',\n          width: input[0].parentNode.offsetWidth + 'px'\n        };\n      };\n\n      scope.scrollActive = function () {\n        $timeout(function () {\n          var active = element[0].querySelector('.treeChooser-active .treeChooser-label');\n          // If no results are shown, there won't be an active!\n          if (active) {\n            list[0].scrollTop = active.offsetTop;\n          }\n        });\n      };\n    }\n  };\n}\n\nmodule.exports = TreeChooser;\n\n\n\n// WEBPACK FOOTER //\n// ./src/treeChooser/treeChooser.directive.js","module.exports = \"<div class=treeChooser ng-attr-tabindex={{vm.tabindex}}> <div class=treeChooser-input ng-class=\\\"{'treeChooser-input-focused': vm.focused}\\\"> <span ng-if=vm.enablePills ng-click=\\\"vm.removeFromModel(item); focusInput();\\\" ng-repeat=\\\"item in vm.getModelAsItems()\\\"> {{item[vm.properties.label]}} </span> <input type=text ng-disabled=vm.ngDisabled ng-model=vm.filterText ng-keydown=vm.onTextKeyDown($event) ng-focus=\\\"vm.focused = true; vm.tryShow($event);\\\" ng-blur=\\\"vm.focused = false\\\" placeholder={{vm.ngPlaceholder}}> </div> <ul ng-show=vm.shown ng-keydown=vm.onListKeyDown($event) ng-style=getListStyles() class=treeChooser-list tabindex=-1> <li ng-repeat=\\\"item in vm.getPresentItems()\\\" tree-chooser-item=item></li> <li ng-if=!vm.getPresentItems().length>No match</li> </ul> </div> \";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/treeChooser/treeChooser.html\n// module id = 8\n// module chunks = 0 1","'use strict';\n\n/*@ngInject*/\nfunction TreeChooserController(\n  $element,\n  $scope,\n  $timeout,\n  $window,\n  TreeChooserItem\n) {\n  var vm = this,\n    _ = require('lodash');\n\n  // @todo create a separate directive for the list\n\n  /**\n   * Show the search results, add outside click handler\n   */\n  vm.show = function () {\n    if (vm.shown) {\n      return;\n    }\n\n    vm.shown = true;\n\n    vm.next();\n\n    // Add event listener to determine when user clicks outside of tree chooser\n    if (!vm.disableClick) {\n      $timeout(function () {\n        $window.addEventListener('click', vm.closeFromClick);\n      });\n    }\n  };\n\n  /**\n   * Show on focus, unless returning from the list\n   * @param {Event} $event\n   */\n  vm.tryShow = function ($event) {\n    if (_.includes(_.get($event.relatedTarget, 'className'), 'treeChooser-list')) {\n      return;\n    }\n    vm.show();\n  };\n\n  /**\n   * Close the search results, remove outside click handler\n   */\n  vm.close = function () {\n    vm.filterText = '';\n    vm.reset();\n    vm.shown = false;\n    vm.clearActive();\n    if (!vm.disableClick) {\n      $window.removeEventListener('click', vm.closeFromClick);\n    }\n  };\n\n  /**\n   * Close on outside click\n   */\n  vm.closeFromClick = function () {\n    vm.close();\n    $scope.$apply();\n  };\n\n  /**\n   * Reset the collapsed and active state\n   */\n  vm.reset = function () {\n    _.forEach(vm.itemsFlat, function (item) {\n      item.setActive(false);\n      item.setExpanded(false);\n    });\n  };\n\n  /**\n   * Handle results keyboard navigation\n   * @param {Object} $event\n   */\n  vm.onListKeyDown = function ($event) {\n    var shouldStop = false;\n\n    switch ($event.keyCode) {\n      case 27: //Escape\n        shouldStop = true;\n        vm.close();\n        $scope.focusInput();\n        break;\n      case 13: //Enter\n        shouldStop = true;\n        vm.toggleSelectedActive();\n        vm.close();\n        $scope.focusInput();\n        break;\n      case 40: //Down Arrow\n        shouldStop = true;\n        vm.next();\n        break;\n      case 38: //Up Arrow\n        shouldStop = true;\n        vm.prev();\n        break;\n      case 37: //Left Arrow\n        shouldStop = true;\n        vm.collapseActive();\n        break;\n      case 39: //Right Arrow\n        shouldStop = true;\n        vm.expandActive();\n        break;\n      case 32: //Space\n        shouldStop = true;\n        vm.toggleSelectedActive();\n        break;\n      case 9: //Tab\n        vm.toggleSelectedActive(true);\n        vm.close();\n        break;\n    }\n\n    if (shouldStop) {\n      $event.preventDefault();\n      $event.stopPropagation();\n    }\n  };\n\n  /**\n   * Handle input keyboard navigation\n   * @param {Object} $event\n   */\n  vm.onTextKeyDown = function ($event) {\n    switch ($event.keyCode) {\n      case 27: //Escape\n        vm.close();\n        break;\n      case 13: //Enter\n        if (vm.shown) {\n          vm.toggleSelectedActive();\n        } else {\n          vm.show($event);\n        }\n        break;\n      case 40: //Down Arrow\n        vm.show($event);\n        $scope.focusList();\n        break;\n      case 8: //Backspace\n        if (_.isEmpty(vm.filterText) && (vm.multiselect ? !_.isEmpty(vm.ngModel.$viewValue) : !_.isNil(vm.ngModel.$viewValue))) {\n          vm.removeFromModel();\n        }\n        break;\n      case 9: //Tab\n        vm.toggleSelectedActive(true);\n        vm.close();\n        break;\n    }\n  };\n\n  /**\n   * Find next visible item\n   */\n  vm.next = function () {\n    if (_.isEmpty(vm.itemsFlat)) {\n      return;\n    }\n\n    var active = vm.findActive();\n\n    if (!active) {\n      var first = _.find(vm.itemsFlat, function (item) {\n        return item.isShowing();\n      });\n      // If no results are shown, there's nothing to set first!\n      if (first) {\n        first.setActive(true);\n      }\n    } else {\n      var start = _.findIndex(vm.itemsFlat, function (item) {\n        return item.isActive();\n      });\n      active.setActive(false);\n\n      // @todo optimize array traversal\n      var next = _.find(vm.itemsFlat, function (item, index) {\n        return index > start && item.isShowing();\n      });\n      if (!next) {\n        next = _.find(vm.itemsFlat, function (item, index) {\n          return index < start && item.isShowing();\n        });\n      }\n      if (next) {\n        next.setActive(true);\n      }\n    }\n\n    $scope.scrollActive();\n  };\n\n  /**\n   * Find previous visible item\n   */\n  vm.prev = function () {\n    var active = vm.findActive();\n\n    if (!active) {\n      var last = _.findLast(vm.itemsFlat, function (item) {\n        return item.isShowing();\n      });\n      // If no results are shown, there's nothing to set last!\n      if (last) {\n        last.setActive(true);\n      }\n    } else {\n      var start = _.findIndex(vm.itemsFlat, function (item) {\n        return item.isActive();\n      });\n      active.setActive(false);\n\n      // @todo optimize array traversal\n      var prev = _.findLast(vm.itemsFlat, function (item, index) {\n        return index < start && item.isShowing();\n      });\n      if (!prev) {\n        prev = _.findLast(vm.itemsFlat, function (item, index) {\n          return index > start && item.isShowing();\n        });\n      }\n      if (prev) {\n        prev.setActive(true);\n      }\n    }\n\n    $scope.scrollActive();\n  };\n\n  /**\n   * Expand active item\n   */\n  vm.expandActive = function () {\n    var active = vm.findActive();\n    if (active) {\n      active.setExpanded(true);\n    }\n  };\n\n  /**\n   * Collapse active item\n   */\n  vm.collapseActive = function () {\n    var active = vm.findActive();\n    if (active) {\n      active.setExpanded(false);\n    }\n  };\n\n  /**\n   * Set all items inactive\n   */\n  vm.clearActive = function () {\n    _.forEach(vm.itemsFlat, function (item) {\n      item.setActive(false);\n    });\n  };\n\n  /**\n   * Toggle selection on active item\n   * @param {boolean} [isTab]\n   */\n  vm.toggleSelectedActive = function (isTab) {\n    var active = vm.findActive();\n    if (active) {\n      // Don't unselect on tab\n      if (isTab && active.isSelected()) {\n        return;\n      }\n      vm.toggleSelected(active);\n    }\n  };\n\n  /**\n   * Get the active item\n   */\n  vm.findActive = function () {\n    return _.find(vm.itemsFlat, function (item) {\n      return item.isActive();\n    });\n  };\n\n  /**\n   * Toggle selected unless disabled\n   */\n  vm.toggleSelected = function (item) {\n    if (vm.disableNode(item)) {\n      return;\n    }\n\n    vm.setSelected(item, !item.isSelected());\n    if (item.isSelected() && !vm.multiselect) {\n      vm.close();\n    }\n  };\n\n  /**\n   * Select all unfiltered children\n   */\n  vm.selectChildren = function (item) {\n    _.forEach(item.getPresentChildren(), function (child) {\n      if (!child.isSelected()) {\n        vm.setSelected(child, true);\n      }\n      vm.selectChildren(child);\n    });\n  };\n\n  /**\n   * Deselect all children\n   */\n  vm.deselectChildren = function (item) {\n    _.forEach(item.getChildren(), function (child) {\n      if (child.isSelected()) {\n        vm.setSelected(child, false);\n      }\n      vm.deselectChildren(child);\n    });\n  };\n\n  /**\n   * Set selection state\n   */\n  vm.setSelected = function (item, value) {\n    // Enforce leaf only restrictions if necessary\n    if (value && vm.onlyLeaves && !item.isLeaf()) {\n      value = false;\n    }\n    item.setSelected(value);\n    if (value) {\n      vm.addToModel(item);\n      if (vm.selectsChildren && vm.multiselect) {\n        vm.selectChildren(item);\n      } else if (!vm.selectsChildren && !vm.multiselect) {\n        $scope.focusTreeChooserDiv();\n      }\n    } else {\n      vm.removeFromModel(item.getItem());\n      if (vm.deselectsChildren && vm.multiselect) {\n        vm.deselectChildren(item);\n      }\n    }\n  };\n\n  /**\n   * Get top level present items\n   */\n  vm.getPresentItems = function () {\n    return _.filter(vm.items, function (item) {\n      return item.isPresent();\n    });\n  };\n\n  /**\n   * Determine if visible or not\n   * @todo isMatch, isPresent, isExcluded, etc all needs to better naming\n   */\n  vm.isMatch = function (item) {\n    if (!vm.filterText) {\n      return true;\n    }\n    return vm.filterNode(item.getItem(), vm.filterText);\n  };\n\n  /**\n   * Recursively set exclusions so that parents of included children aren't hidden\n   * @param {Array} items\n   * @param {boolean} parentMatched\n   */\n  vm.setExclusions = function (items, parentMatched) {\n    _.forEach(items, function (item) {\n      vm.setExclusions(item.getChildren(), parentMatched || vm.isMatch(item));\n      item.setExcluded(!vm.isMatch(item) && !item.hasAChildPresent() && !parentMatched);\n    });\n  };\n\n  /**\n   * Recursively set exclusions so that parents of included children aren't hidden\n   */\n  vm.showAll = function () {\n    _(vm.itemsFlat)\n      .filter(function (item) {\n        return item.isPresent();\n      })\n      .forEach(function (item) {\n        item.setExpanded(true);\n      });\n\n    vm.show();\n  };\n\n  /**\n   * Set active property to false if active item exists\n   */\n  vm.resetActive = function () {\n    var active = vm.findActive();\n    if (active) {\n      active.setActive(false);\n    }\n  };\n\n  /**\n   * Clear all no leaves\n   * @todo if deselect Children is enabled, won't this deselect leaves?\n   */\n  vm.clearBranches = function () {\n    _.forEach(vm.itemsFlat, function (item) {\n      if (!item.isLeaf() && item.isSelected()) {\n        vm.setSelected(item, false);\n      }\n    });\n  };\n\n  /**\n   * Get model as items because it could be saved as id\n   */\n  vm.getModelAsItems = function () {\n    return _(vm.multiselect ? vm.ngModel.$viewValue : [vm.ngModel.$viewValue])\n      .map(function (item) {\n        // Can' guarantee the item still exists unless restrict model is on\n        return vm.modelAsId ? _.invoke(vm.itemsIndex[item], 'getItem') : item;\n      })\n      .compact()\n      .value();\n  };\n\n  /**\n   * Add item to model and trigger validation\n   */\n  vm.addToModel = function (item) {\n    var value = vm.modelAsId ? item.getId() : item.getItem();\n    if (vm.multiselect) {\n      vm.ngModel.$viewValue.push(value);\n      vm.ngModel.$validate();\n    } else {\n      vm.ngModel.$setViewValue(value);\n    }\n  };\n\n  /**\n   * Remove item from model and trigger validation\n   */\n  vm.removeFromModel = function (item) {\n    if (!vm.multiselect) {\n      vm.ngModel.$setViewValue(null);\n      $scope.removeTabindex();\n    } else {\n      if (item) {\n        var id = _.get(item, vm.properties.id);\n        _.remove(vm.ngModel.$viewValue, function (item) {\n          return vm.modelAsId ? item === id : _.get(item, vm.properties.id) === id;\n        });\n      } else {\n        vm.ngModel.$viewValue.pop();\n      }\n      vm.ngModel.$validate();\n    }\n  };\n\n  /**\n   * Sync model to items in case model, items or restrictModel changes\n   */\n  vm.syncModelToItems = _.debounce(function () {\n    _.forEach(vm.itemsFlat, function (item) {\n      item.setSelected(false);\n    });\n\n    var model = vm.multiselect ? vm.ngModel.$modelValue : [vm.ngModel.$modelValue];\n\n    var toDelete = [];\n    // Set selected items back to true\n    _.forEach(model, function (item) {\n      var id = vm.modelAsId ? item : _.get(item, vm.properties.id);\n      var checkItem = vm.itemsIndex[id];\n      if (checkItem) {\n        checkItem.setSelected(true);\n        if (vm.isInitialLoad) {\n          vm.isInitialLoad = false;\n          if (!vm.selectsChildren && !vm.multiselect) {\n            $scope.addTabindex();\n          }\n        }\n      } else if (vm.restrictModel) {\n        toDelete.push(item);\n      }\n    });\n\n    _.forEach(toDelete, function (item) {\n      vm.removeFromModel(item);\n    });\n\n    // This is debounced, so ensure scope is applied!\n    $scope.$apply();\n  });\n\n  /**\n   * Create TreeChooserItem hierarchy\n   */\n  vm.createItems = function (items) {\n    return _.map(items, function (item) {\n      return new TreeChooserItem(item, null, vm.properties);\n    });\n  };\n\n  /**\n   * Flatten hierarchy for more efficient processing\n   */\n  vm.flattenItems = function (items) {\n    return _(items)\n      .map(function (item) {\n        return [item, vm.flattenItems(item.getChildren())];\n      })\n      .flattenDeep()\n      .value();\n  };\n\n  /**\n   * Set the active element on search\n   */\n  vm.setActive = function () {\n    vm.resetActive();\n    var first;\n    if (vm.onlyLeaves) {\n      // Find first present leaf in flat items\n      first = _.find(vm.itemsFlat, function (item) {\n        return item.isLeaf() && item.isPresent();\n      });\n    } else {\n      // Find first present branch, at least one branch will be present in items\n      first = _.find(vm.items, function (item) {\n        return item.isPresent();\n      });\n    }\n\n    if (first) {\n      first.setActive(true);\n    }\n  };\n\n  this.$onInit = function () {\n    // Flag to determine whether search results are showing\n    vm.shown = false;\n\n    // flag indicating that this is the initial load\n    vm.isInitialLoad = true;\n\n    // default .treeChooser tabindex value\n    vm.tabindex='-1';\n\n    // Properties use to access special parts of item\n    vm.properties = {\n      id: vm.idProperty || 'id',\n      label: vm.labelProperty || 'label',\n      children: vm.childrenProperty || 'children'\n    };\n\n    // Enable multiselect by default\n    if (_.isUndefined(vm.multiselect)) {\n      vm.multiselect = true;\n    }\n    // Disable only leaves by default\n    if (_.isUndefined(vm.onlyLeaves)) {\n      vm.onlyLeaves = false;\n    }\n    // Disable selects children by default\n    if (_.isUndefined(vm.selectsChildren)) {\n      vm.selectsChildren = false;\n    }\n    // Disable deselects children by default\n    if (_.isUndefined(vm.deselectsChildren)) {\n      vm.deselectsChildren = false;\n    }\n    // Disable restrict model by default\n    if (_.isUndefined(vm.restrictModel)) {\n      vm.restrictModel = false;\n    }\n    // Enable pills by default\n    if (_.isUndefined(vm.enablePills)) {\n      vm.enablePills = true;\n    }\n    // Save ID to model by default\n    if (_.isUndefined(vm.modelAsId)) {\n      vm.modelAsId = true;\n    }\n    // Auto show after specified filter text length\n    if (!_.isNumber(vm.filterAutoShowLength)) {\n      vm.filterAutoShowLength = 2;\n    }\n    // Default filter node function\n    if (!_.isFunction(vm.filterNode)) {\n      vm.filterNode = function (item, filterText) {\n        return _.includes(_.toLower(_.get(item, vm.properties.label)), _.toLower(filterText));\n      };\n    }\n    // Default disable node function\n    if (!_.isFunction(vm.disableNode)) {\n      vm.disableNode = _.stubFalse;\n    }\n    // Default to enable close to click\n    if (!_.isUndefined(vm.disableClick)) {\n      vm.disableClick = false;\n    }\n\n    // Get access to ngModel\n    vm.ngModel = $element.controller('ngModel');\n    // And override $isEmpty to account for array emptiness if multiselect\n    if (vm.multiselect) {\n      vm.ngModel.$isEmpty = _.isEmpty;\n    }\n\n    this.registerWatches();\n  };\n\n  this.registerWatches = function () {\n    /**\n     * Update exclusions on filter text change\n     */\n    $scope.$watch('vm.filterText', function () {\n      vm.setExclusions(vm.items);\n      if (_.size(vm.filterText) >= vm.filterAutoShowLength) {\n        vm.showAll();\n        vm.setActive();\n      } else {\n        vm.reset();\n      }\n    });\n\n    /**\n     * Sync on model change\n     */\n    $scope.$watchCollection('vm.ngModel.$modelValue', function () {\n      vm.syncModelToItems();\n    });\n\n    /**\n     * Sync on items change\n     */\n    $scope.$watch('vm.treeData', function () {\n      // @todo is this manual GC needed?\n      _.forEach(vm.itemsFlat, function (item, index) {\n        delete vm.itemsFlat[index];\n      });\n\n      // Create chooser items, so the underlying model is not touched\n      vm.items = vm.createItems(vm.treeData);\n      // Flatten into a sorted list for easier navigation\n      vm.itemsFlat = vm.flattenItems(vm.items);\n      // Item index\n      vm.itemsIndex = _.keyBy(vm.itemsFlat, function (item) {\n        return item.getId();\n      });\n\n      vm.syncModelToItems();\n    });\n\n    /**\n     * Sync on restrict model\n     */\n    $scope.$watch('vm.restrictModel', function (value) {\n      if (value) {\n        vm.syncModelToItems();\n      }\n    });\n\n    /**\n     * Deselect branches on only leaves true\n     */\n    $scope.$watch('vm.onlyLeaves', function (value) {\n      if (value) {\n        vm.clearBranches();\n      }\n    });\n\n    /**\n     * Disable results on disable\n     */\n    $scope.$watch('vm.ngDisabled', function (value) {\n      if (value) {\n        vm.close();\n      }\n    });\n  };\n}\n\nmodule.exports = TreeChooserController;\n\n\n\n// WEBPACK FOOTER //\n// ./src/treeChooser/treeChooser.controller.js","module.exports = require(\"lodash\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"lodash\"}\n// module id = 10\n// module chunks = 0 1","'use strict';\n\nmodule.exports = function (treeChooser) {\n  treeChooser\n    .directive('treeChooserItem', require('./treeChooserItem.directive'))\n    .controller('treeChooserItemController', require('./treeChooserItem.controller'))\n    .factory('TreeChooserItem', require('./treeChooserItem.factory'));\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/treeChooserItem/index.js","'use strict';\n\nfunction TreeChooserItem() {\n  return {\n    bindToController: true,\n    controller: 'treeChooserItemController',\n    controllerAs: 'vm',\n    require: '^treeChooser',\n    scope: {\n      item: '=treeChooserItem'\n    },\n    template: require('./treeChooserItem.html'),\n  };\n}\n\nmodule.exports = TreeChooserItem;\n\n\n\n// WEBPACK FOOTER //\n// ./src/treeChooserItem/treeChooserItem.directive.js","module.exports = \"<span class=treeChooser-item ng-class=\\\"{'treeChooser-selected': vm.item.isSelected(), 'treeChooser-active': vm.item.isActive()}\\\"> <span class=treeChooser-expansion ng-click=\\\"vm.chooserVm.clearActive(); vm.item.setActive(true); vm.item.toggleExpanded()\\\"> <span ng-show=\\\"vm.item.hasAChildPresent() && vm.item.isExpanded()\\\" class=treeChooser-expanded>-</span> <span ng-show=\\\"vm.item.hasAChildPresent() && !vm.item.isExpanded()\\\" class=treeChooser-collapsed>+</span> </span> <span class=treeChooser-label ng-class=\\\"{'treeChooser-disabled': vm.chooserVm.disableNode(vm.item)}\\\" ng-click=\\\"vm.chooserVm.clearActive(); vm.item.setActive(true); vm.chooserVm.toggleSelected(vm.item)\\\"> {{vm.item.getLabel()}} </span> <ul ng-if=vm.item.isExpanded()> <li ng-repeat=\\\"item in vm.item.getPresentChildren()\\\" tree-chooser-item=item></li> </ul> </span> \";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/treeChooserItem/treeChooserItem.html\n// module id = 13\n// module chunks = 0 1","'use strict';\n\n/*@ngInject*/\nfunction TreeChooserItemController ($element) {\n  var vm = this;\n  vm.chooserVm = $element.controller('treeChooser');\n}\n\nmodule.exports = TreeChooserItemController;\n\n\n\n// WEBPACK FOOTER //\n// ./src/treeChooserItem/treeChooserItem.controller.js","'use strict';\n\nfunction TreeChooserItemFactory () {\n  var _ = require('lodash');\n\n  function TreeChooserItem(item, parent, properties) {\n    this.item = item; // @todo use this for templates\n\n    this.properties = properties;\n    this.id = _.get(this.item, this.properties.id);\n    this.label = _.get(this.item, this.properties.label);\n\n    this.parent = parent;\n\n    this.active = false;\n    this.excluded = false;\n    this.expanded = false;\n    this.selected = false;\n\n    var children = _.get(item, properties.children);\n    this.children = _.map(children, (child) => {\n      return new TreeChooserItem(child, this, properties);\n    });\n  }\n\n  TreeChooserItem.prototype.getItem = function () {\n    return this.item;\n  };\n\n  TreeChooserItem.prototype.getChildren = function () {\n    return this.children;\n  };\n\n  TreeChooserItem.prototype.hasAChildPresent = function () {\n    return !!_.find(this.getChildren(), function (child) {\n      return child.isPresent();\n    });\n  };\n\n  TreeChooserItem.prototype.getPresentChildren = function () {\n    return _.filter(this.getChildren(), function (child) {\n      return child.isPresent();\n    });\n  };\n\n  TreeChooserItem.prototype.getId = function () {\n    return this.id;\n  };\n\n  TreeChooserItem.prototype.getLabel = function () {\n    return this.label;\n  };\n\n  TreeChooserItem.prototype.isActive = function () {\n    return this.active;\n  };\n\n  TreeChooserItem.prototype.isLeaf = function () {\n    return _.isEmpty(this.children);\n  };\n\n  TreeChooserItem.prototype.isShowing = function () {\n    return this.isPresent() && (!this.parent || this.parent.isExpanded());\n  };\n\n  TreeChooserItem.prototype.isPresent = function () {\n    return !this.excluded;\n  };\n\n  TreeChooserItem.prototype.isExpanded = function () {\n    return this.expanded;\n  };\n\n  TreeChooserItem.prototype.isSelected = function () {\n    return this.selected;\n  };\n\n  TreeChooserItem.prototype.setActive = function (value) {\n    this.active = value;\n  };\n\n  TreeChooserItem.prototype.setExcluded = function (value) {\n    this.excluded = value;\n  };\n\n  TreeChooserItem.prototype.setExpanded = function (value) {\n    this.expanded = value;\n  };\n\n  TreeChooserItem.prototype.setSelected = function (value) {\n    this.selected = value;\n  };\n\n  TreeChooserItem.prototype.toggleExpanded = function () {\n    this.expanded = !this.expanded;\n  };\n\n  return TreeChooserItem;\n}\n\nmodule.exports = TreeChooserItemFactory;\n\n\n\n// WEBPACK FOOTER //\n// ./src/treeChooserItem/treeChooserItem.factory.js"],"sourceRoot":""}