exports["tree-chooser"]=function(e){function t(n){if(i[n])return i[n].exports;var o=i[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){"use strict";var n=i(1),o=n.module("treeChooser",[]);i(2)(o),i(11)(o),e.exports=o},function(e,t){e.exports=require("angular")},function(e,t,i){"use strict";e.exports=function(e){e.directive("treeChooser",i(3)).controller("treeChooserController",i(9))}},function(e,t,i){"use strict";function n(e){i(4);var t=i(1);return{bindToController:!0,controller:"treeChooserController",controllerAs:"vm",require:["ngModel"],scope:{treeData:"=treeChooser",idProperty:"@",labelProperty:"@",childrenProperty:"@",deselectsChildren:"=?",disableNode:"=?",filterNode:"=?",filterAutoShowLength:"=?",multiselect:"=?",ngDisabled:"=?",ngPlaceholder:"=?",onlyLeaves:"=?",restrictModel:"=?",selectsChildren:"=?",enablePills:"=?",modelAsId:"=?",disableClick:"=?"},template:i(8),link:function(i,n){var o=t.element(n[0].querySelector(".treeChooser-input input"));o.on("click",function(e){e.stopPropagation()});var s=t.element(n[0].querySelector(".treeChooser-list"));s.on("click",function(e){e.stopPropagation()}),i.focusInput=function(){e(function(){o[0].focus()})},i.focusList=function(){e(function(){s[0].focus()})},i.getListStyles=function(){return{top:o[0].parentNode.offsetHeight+"px",width:o[0].parentNode.offsetWidth+"px"}},i.scrollActive=function(){e(function(){var e=n[0].querySelector(".treeChooser-active .treeChooser-label");e&&(s[0].scrollTop=e.offsetTop)})}}}}n.$inject=["$timeout"],e.exports=n},function(e,t){},,,,function(e,t){e.exports='<div class=treeChooser> <div class=treeChooser-input ng-class="{\'treeChooser-input-focused\': vm.focused}"> <span ng-if=vm.enablePills ng-click="vm.removeFromModel(item); focusInput();" ng-repeat="item in vm.getModelAsItems()"> {{item[vm.properties.label]}} </span> <input type=text ng-disabled=vm.ngDisabled ng-model=vm.filterText ng-keydown=vm.onTextKeyDown($event) ng-focus="vm.focused = true; vm.tryShow($event);" ng-blur="vm.focused = false" placeholder={{vm.ngPlaceholder}}> </div> <ul ng-show=vm.shown ng-keydown=vm.onListKeyDown($event) ng-style=getListStyles() class=treeChooser-list tabindex=-1> <li ng-repeat="item in vm.getPresentItems()" tree-chooser-item=item></li> <li ng-if=!vm.getPresentItems().length>No match</li> </ul> </div> '},function(e,t,i){"use strict";function n(e,t,n,o){var s=this,r=i(10);s.show=function(){s.shown||(s.shown=!0,s.next(),s.disableClick||n.addEventListener("click",s.closeFromClick))},s.tryShow=function(e){r.includes(r.get(e.relatedTarget,"className"),"treeChooser-list")||s.show()},s.close=function(){s.filterText="",s.reset(),s.shown=!1,s.clearActive(),s.disableClick||n.removeEventListener("click",s.closeFromClick)},s.closeFromClick=function(){s.close(),t.$apply()},s.reset=function(){r.forEach(s.itemsFlat,function(e){e.setActive(!1),e.setExpanded(!1)})},s.onListKeyDown=function(e){var i=!1;switch(e.keyCode){case 27:i=!0,s.close(),t.focusInput();break;case 13:i=!0,s.toggleSelectedActive(),s.close(),t.focusInput();break;case 40:i=!0,s.next();break;case 38:i=!0,s.prev();break;case 37:i=!0,s.collapseActive();break;case 39:i=!0,s.expandActive();break;case 32:i=!0,s.toggleSelectedActive();break;case 9:s.toggleSelectedActive(!0),s.close()}i&&(e.preventDefault(),e.stopPropagation())},s.onTextKeyDown=function(e){switch(e.keyCode){case 27:s.close();break;case 13:s.shown?s.toggleSelectedActive():s.show(e);break;case 40:s.show(e),t.focusList();break;case 8:!r.isEmpty(s.filterText)||(s.multiselect?r.isEmpty(s.ngModel.$viewValue):r.isNil(s.ngModel.$viewValue))||s.removeFromModel();break;case 9:s.toggleSelectedActive(!0),s.close()}},s.next=function(){if(!r.isEmpty(s.itemsFlat)){var e=s.findActive();if(e){var i=r.findIndex(s.itemsFlat,function(e){return e.isActive()});e.setActive(!1);var n=r.find(s.itemsFlat,function(e,t){return t>i&&e.isShowing()});n||(n=r.find(s.itemsFlat,function(e,t){return t<i&&e.isShowing()})),n&&n.setActive(!0)}else{var o=r.find(s.itemsFlat,function(e){return e.isShowing()});o&&o.setActive(!0)}t.scrollActive()}},s.prev=function(){var e=s.findActive();if(e){var i=r.findIndex(s.itemsFlat,function(e){return e.isActive()});e.setActive(!1);var n=r.findLast(s.itemsFlat,function(e,t){return t<i&&e.isShowing()});n||(n=r.findLast(s.itemsFlat,function(e,t){return t>i&&e.isShowing()})),n&&n.setActive(!0)}else{var o=r.findLast(s.itemsFlat,function(e){return e.isShowing()});o&&o.setActive(!0)}t.scrollActive()},s.expandActive=function(){var e=s.findActive();e&&e.setExpanded(!0)},s.collapseActive=function(){var e=s.findActive();e&&e.setExpanded(!1)},s.clearActive=function(){r.forEach(s.itemsFlat,function(e){e.setActive(!1)})},s.toggleSelectedActive=function(e){var t=s.findActive();if(t){if(e&&t.isSelected())return;s.toggleSelected(t)}},s.findActive=function(){return r.find(s.itemsFlat,function(e){return e.isActive()})},s.toggleSelected=function(e){s.disableNode(e)||(s.setSelected(e,!e.isSelected()),e.isSelected()&&!s.multiselect&&s.close())},s.selectChildren=function(e){r.forEach(e.getPresentChildren(),function(e){e.isSelected()||s.setSelected(e,!0),s.selectChildren(e)})},s.deselectChildren=function(e){r.forEach(e.getChildren(),function(e){e.isSelected()&&s.setSelected(e,!1),s.deselectChildren(e)})},s.setSelected=function(e,t){t&&s.onlyLeaves&&!e.isLeaf()&&(t=!1),e.setSelected(t),t?(s.addToModel(e),s.selectsChildren&&s.multiselect&&s.selectChildren(e)):(s.removeFromModel(e.getItem()),s.deselectsChildren&&s.multiselect&&s.deselectChildren(e))},s.getPresentItems=function(){return r.filter(s.items,function(e){return e.isPresent()})},s.isMatch=function(e){return!s.filterText||s.filterNode(e.getItem(),s.filterText)},s.setExclusions=function(e,t){r.forEach(e,function(e){s.setExclusions(e.getChildren(),t||s.isMatch(e)),e.setExcluded(!s.isMatch(e)&&!e.hasAChildPresent()&&!t)})},s.showAll=function(){r(s.itemsFlat).filter(function(e){return e.isPresent()}).forEach(function(e){e.setExpanded(!0)}),s.show()},s.clearBranches=function(){r.forEach(s.itemsFlat,function(e){!e.isLeaf()&&e.isSelected()&&s.setSelected(e,!1)})},s.getModelAsItems=function(){return r(s.multiselect?s.ngModel.$viewValue:[s.ngModel.$viewValue]).map(function(e){return s.modelAsId?r.invoke(s.itemsIndex[e],"getItem"):e}).compact().value()},s.addToModel=function(e){var t=s.modelAsId?e.getId():e.getItem();s.multiselect?(s.ngModel.$viewValue.push(t),s.ngModel.$validate()):s.ngModel.$setViewValue(t)},s.removeFromModel=function(e){if(s.multiselect){if(e){var t=r.get(e,s.properties.id);r.remove(s.ngModel.$viewValue,function(e){return s.modelAsId?e===t:r.get(e,s.properties.id)===t})}else s.ngModel.$viewValue.pop();s.ngModel.$validate()}else s.ngModel.$setViewValue(null)},s.syncModelToItems=r.debounce(function(){r.forEach(s.itemsFlat,function(e){e.setSelected(!1)});var e=s.multiselect?s.ngModel.$modelValue:[s.ngModel.$modelValue],i=[];r.forEach(e,function(e){var t=s.modelAsId?e:r.get(e,s.properties.id),n=s.itemsIndex[t];n?n.setSelected(!0):s.restrictModel&&i.push(e)}),r.forEach(i,function(e){s.removeFromModel(e)}),t.$apply()}),s.createItems=function(e){return r.map(e,function(e){return new o(e,null,s.properties)})},s.flattenItems=function(e){return r(e).map(function(e){return[e,s.flattenItems(e.getChildren())]}).flattenDeep().value()},s.setActive=function(){var e=s.findActive();if(!e||!e.isPresent()){e&&e.setActive(!1);var t;t=s.onlyLeaves?r.find(s.itemsFlat,function(e){return e.isLeaf()&&e.isPresent()}):r.find(s.items,function(e){return e.isPresent()}),t&&t.setActive(!0)}},this.$onInit=function(){s.shown=!1,s.properties={id:s.idProperty||"id",label:s.labelProperty||"label",children:s.childrenProperty||"children"},r.isUndefined(s.multiselect)&&(s.multiselect=!0),r.isUndefined(s.onlyLeaves)&&(s.onlyLeaves=!1),r.isUndefined(s.selectsChildren)&&(s.selectsChildren=!1),r.isUndefined(s.deselectsChildren)&&(s.deselectsChildren=!1),r.isUndefined(s.restrictModel)&&(s.restrictModel=!1),r.isUndefined(s.enablePills)&&(s.enablePills=!0),r.isUndefined(s.modelAsId)&&(s.modelAsId=!0),r.isNumber(s.filterAutoShowLength)||(s.filterAutoShowLength=2),r.isFunction(s.filterNode)||(s.filterNode=function(e,t){return r.includes(r.toLower(r.get(e,s.properties.label)),r.toLower(t))}),r.isFunction(s.disableNode)||(s.disableNode=r.stubFalse),r.isUndefined(s.disableClick)||(s.disableClick=!1),s.ngModel=e.controller("ngModel"),s.multiselect&&(s.ngModel.$isEmpty=r.isEmpty),this.registerWatches()},this.registerWatches=function(){t.$watch("vm.filterText",function(){s.setExclusions(s.items),r.size(s.filterText)===s.filterAutoShowLength&&s.showAll(),s.setActive()}),t.$watchCollection("vm.ngModel.$modelValue",function(){s.syncModelToItems()}),t.$watch("vm.treeData",function(){r.forEach(s.itemsFlat,function(e,t){delete s.itemsFlat[t]}),s.items=s.createItems(s.treeData),s.itemsFlat=s.flattenItems(s.items),s.itemsIndex=r.keyBy(s.itemsFlat,function(e){return e.getId()}),s.syncModelToItems()}),t.$watch("vm.restrictModel",function(e){e&&s.syncModelToItems()}),t.$watch("vm.onlyLeaves",function(e){e&&s.clearBranches()}),t.$watch("vm.ngDisabled",function(e){e&&s.close()})}}n.$inject=["$element","$scope","$window","TreeChooserItem"],e.exports=n},function(e,t){e.exports=require("lodash")},function(e,t,i){"use strict";e.exports=function(e){e.directive("treeChooserItem",i(12)).controller("treeChooserItemController",i(14)).factory("TreeChooserItem",i(15))}},function(e,t,i){"use strict";function n(){return{bindToController:!0,controller:"treeChooserItemController",controllerAs:"vm",require:"^treeChooser",scope:{item:"=treeChooserItem"},template:i(13)}}e.exports=n},function(e,t){e.exports='<span class=treeChooser-item ng-class="{\'treeChooser-selected\': vm.item.isSelected(), \'treeChooser-active\': vm.item.isActive()}"> <span class=treeChooser-expansion ng-click="vm.chooserVm.clearActive(); vm.item.setActive(true); vm.item.toggleExpanded()"> <span ng-show="vm.item.hasAChildPresent() && vm.item.isExpanded()" class=treeChooser-expanded>-</span> <span ng-show="vm.item.hasAChildPresent() && !vm.item.isExpanded()" class=treeChooser-collapsed>+</span> </span> <span class=treeChooser-label ng-class="{\'treeChooser-disabled\': vm.chooserVm.disableNode(vm.item)}" ng-click="vm.chooserVm.clearActive(); vm.item.setActive(true); vm.chooserVm.toggleSelected(vm.item)"> {{vm.item.getLabel()}} </span> <ul ng-if=vm.item.isExpanded()> <li ng-repeat="item in vm.item.getPresentChildren()" tree-chooser-item=item></li> </ul> </span> '},function(e,t){"use strict";function i(e){var t=this;t.chooserVm=e.controller("treeChooser")}i.$inject=["$element"],e.exports=i},function(e,t,i){"use strict";function n(){function e(i,n,o){var s=this;this.item=i,this.properties=o,this.id=t.get(this.item,this.properties.id),this.label=t.get(this.item,this.properties.label),this.parent=n,this.active=!1,this.excluded=!1,this.expanded=!1,this.selected=!1;var r=t.get(i,o.children);this.children=t.map(r,function(t){return new e(t,s,o)})}var t=i(10);return e.prototype.getItem=function(){return this.item},e.prototype.getChildren=function(){return this.children},e.prototype.hasAChildPresent=function(){return!!t.find(this.getChildren(),function(e){return e.isPresent()})},e.prototype.getPresentChildren=function(){return t.filter(this.getChildren(),function(e){return e.isPresent()})},e.prototype.getId=function(){return this.id},e.prototype.getLabel=function(){return this.label},e.prototype.isActive=function(){return this.active},e.prototype.isLeaf=function(){return t.isEmpty(this.children)},e.prototype.isShowing=function(){return this.isPresent()&&(!this.parent||this.parent.isExpanded())},e.prototype.isPresent=function(){return!this.excluded},e.prototype.isExpanded=function(){return this.expanded},e.prototype.isSelected=function(){return this.selected},e.prototype.setActive=function(e){this.active=e},e.prototype.setExcluded=function(e){this.excluded=e},e.prototype.setExpanded=function(e){this.expanded=e},e.prototype.setSelected=function(e){this.selected=e},e.prototype.toggleExpanded=function(){this.expanded=!this.expanded},e}e.exports=n}]);
//# sourceMappingURL=tree-chooser.min.js.map