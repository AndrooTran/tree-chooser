exports["tree-chooser"]=function(e){function t(n){if(i[n])return i[n].exports;var o=i[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){"use strict";var n=i(1),o=n.module("treeChooser",[]);i(2)(o),i(11)(o),e.exports=o},function(e,t){e.exports=require("angular")},function(e,t,i){"use strict";e.exports=function(e){e.directive("treeChooser",i(3)).controller("treeChooserController",i(9))}},function(e,t,i){"use strict";function n(e){i(4);var t=i(1);return{bindToController:!0,controller:"treeChooserController",controllerAs:"vm",require:["ngModel"],scope:{treeData:"=treeChooser",idProperty:"@",labelProperty:"@",childrenProperty:"@",deselectsChildren:"=?",disableNode:"=?",filterNode:"=?",filterAutoShowLength:"=?",multiselect:"=?",ngDisabled:"=?",ngPlaceholder:"=?",onlyLeaves:"=?",restrictModel:"=?",selectsChildren:"=?",enablePills:"=?",modelAsId:"=?",disableClick:"=?"},template:i(8),link:function(i,n){var o=t.element(n[0].querySelector(".treeChooser-input input"));o.on("click",function(e){e.stopPropagation()});var s=t.element(n[0].querySelector(".treeChooser-list"));s.on("click",function(e){e.stopPropagation()}),i.focusInput=function(){e(function(){o[0].focus()})},i.focusList=function(){e(function(){s[0].focus()})},i.getListStyles=function(){return{top:o[0].parentNode.offsetHeight+"px",width:o[0].parentNode.offsetWidth+"px"}},i.scrollActive=function(){e(function(){var e=n[0].querySelector(".treeChooser-active .treeChooser-label");e&&(s[0].scrollTop=e.offsetTop)})}}}}n.$inject=["$timeout"],e.exports=n},function(e,t){},,,,function(e,t){e.exports='<div class=treeChooser> <div class=treeChooser-input ng-class="{\'treeChooser-input-focused\': vm.focused}"> <span ng-if=vm.enablePills ng-click="vm.removeFromModel(item); focusInput();" ng-repeat="item in vm.getModelAsItems()"> {{item[vm.properties.label]}} </span> <input type=text ng-disabled=vm.ngDisabled ng-model=vm.filterText ng-keydown=vm.onTextKeyDown($event) ng-focus="vm.focused = true; vm.tryShow($event);" ng-blur="vm.focused = false" placeholder={{vm.ngPlaceholder}}> </div> <ul ng-show=vm.shown ng-keydown=vm.onListKeyDown($event) ng-style=getListStyles() class=treeChooser-list tabindex=-1> <li ng-repeat="item in vm.getPresentItems()" tree-chooser-item=item></li> <li ng-if=!vm.getPresentItems().length>No match</li> </ul> </div> '},function(e,t,i){"use strict";function n(e,t,n,o,s){var r=this,l=i(10);r.show=function(){r.shown||(r.shown=!0,r.next(),r.disableClick||n(function(){o.addEventListener("click",r.closeFromClick)}))},r.tryShow=function(e){l.includes(l.get(e.relatedTarget,"className"),"treeChooser-list")||r.show()},r.close=function(){r.filterText="",r.reset(),r.shown=!1,r.clearActive(),r.disableClick||o.removeEventListener("click",r.closeFromClick)},r.closeFromClick=function(){r.close(),t.$apply()},r.reset=function(){l.forEach(r.itemsFlat,function(e){e.setActive(!1),e.setExpanded(!1)})},r.onListKeyDown=function(e){var i=!1;switch(e.keyCode){case 27:i=!0,r.close(),t.focusInput();break;case 13:i=!0,r.toggleSelectedActive(),r.close(),t.focusInput();break;case 40:i=!0,r.next();break;case 38:i=!0,r.prev();break;case 37:i=!0,r.collapseActive();break;case 39:i=!0,r.expandActive();break;case 32:i=!0,r.toggleSelectedActive();break;case 9:r.toggleSelectedActive(!0),r.close()}i&&(e.preventDefault(),e.stopPropagation())},r.onTextKeyDown=function(e){switch(e.keyCode){case 27:r.close();break;case 13:r.shown?r.toggleSelectedActive():r.show(e);break;case 40:r.show(e),t.focusList();break;case 8:!l.isEmpty(r.filterText)||(r.multiselect?l.isEmpty(r.ngModel.$viewValue):l.isNil(r.ngModel.$viewValue))||r.removeFromModel();break;case 9:r.toggleSelectedActive(!0),r.close()}},r.next=function(){if(!l.isEmpty(r.itemsFlat)){var e=r.findActive();if(e){var i=l.findIndex(r.itemsFlat,function(e){return e.isActive()});e.setActive(!1);var n=l.find(r.itemsFlat,function(e,t){return t>i&&e.isShowing()});n||(n=l.find(r.itemsFlat,function(e,t){return t<i&&e.isShowing()})),n&&n.setActive(!0)}else{var o=l.find(r.itemsFlat,function(e){return e.isShowing()});o&&o.setActive(!0)}t.scrollActive()}},r.prev=function(){var e=r.findActive();if(e){var i=l.findIndex(r.itemsFlat,function(e){return e.isActive()});e.setActive(!1);var n=l.findLast(r.itemsFlat,function(e,t){return t<i&&e.isShowing()});n||(n=l.findLast(r.itemsFlat,function(e,t){return t>i&&e.isShowing()})),n&&n.setActive(!0)}else{var o=l.findLast(r.itemsFlat,function(e){return e.isShowing()});o&&o.setActive(!0)}t.scrollActive()},r.expandActive=function(){var e=r.findActive();e&&e.setExpanded(!0)},r.collapseActive=function(){var e=r.findActive();e&&e.setExpanded(!1)},r.clearActive=function(){l.forEach(r.itemsFlat,function(e){e.setActive(!1)})},r.toggleSelectedActive=function(e){var t=r.findActive();if(t){if(e&&t.isSelected())return;r.toggleSelected(t)}},r.findActive=function(){return l.find(r.itemsFlat,function(e){return e.isActive()})},r.toggleSelected=function(e){r.disableNode(e)||(r.setSelected(e,!e.isSelected()),e.isSelected()&&!r.multiselect&&r.close())},r.selectChildren=function(e){l.forEach(e.getPresentChildren(),function(e){e.isSelected()||r.setSelected(e,!0),r.selectChildren(e)})},r.deselectChildren=function(e){l.forEach(e.getChildren(),function(e){e.isSelected()&&r.setSelected(e,!1),r.deselectChildren(e)})},r.setSelected=function(e,t){t&&r.onlyLeaves&&!e.isLeaf()&&(t=!1),e.setSelected(t),t?(r.addToModel(e),r.selectsChildren&&r.multiselect&&r.selectChildren(e)):(r.removeFromModel(e.getItem()),r.deselectsChildren&&r.multiselect&&r.deselectChildren(e))},r.getPresentItems=function(){return l.filter(r.items,function(e){return e.isPresent()})},r.isMatch=function(e){return!r.filterText||r.filterNode(e.getItem(),r.filterText)},r.setExclusions=function(e,t){l.forEach(e,function(e){r.setExclusions(e.getChildren(),t||r.isMatch(e)),e.setExcluded(!r.isMatch(e)&&!e.hasAChildPresent()&&!t)})},r.showAll=function(){l(r.itemsFlat).filter(function(e){return e.isPresent()}).forEach(function(e){e.setExpanded(!0)}),r.show()},r.resetActive=function(){var e=r.findActive();e&&e.setActive(!1)},r.clearBranches=function(){l.forEach(r.itemsFlat,function(e){!e.isLeaf()&&e.isSelected()&&r.setSelected(e,!1)})},r.getModelAsItems=function(){return l(r.multiselect?r.ngModel.$viewValue:[r.ngModel.$viewValue]).map(function(e){return r.modelAsId?l.invoke(r.itemsIndex[e],"getItem"):e}).compact().value()},r.addToModel=function(e){var t=r.modelAsId?e.getId():e.getItem();r.multiselect?(r.ngModel.$viewValue.push(t),r.ngModel.$validate()):r.ngModel.$setViewValue(t)},r.removeFromModel=function(e){if(r.multiselect){if(e){var t=l.get(e,r.properties.id);l.remove(r.ngModel.$viewValue,function(e){return r.modelAsId?e===t:l.get(e,r.properties.id)===t})}else r.ngModel.$viewValue.pop();r.ngModel.$validate()}else r.ngModel.$setViewValue(null)},r.syncModelToItems=l.debounce(function(){l.forEach(r.itemsFlat,function(e){e.setSelected(!1)});var e=r.multiselect?r.ngModel.$modelValue:[r.ngModel.$modelValue],i=[];l.forEach(e,function(e){var t=r.modelAsId?e:l.get(e,r.properties.id),n=r.itemsIndex[t];n?n.setSelected(!0):r.restrictModel&&i.push(e)}),l.forEach(i,function(e){r.removeFromModel(e)}),t.$apply()}),r.createItems=function(e){return l.map(e,function(e){return new s(e,null,r.properties)})},r.flattenItems=function(e){return l(e).map(function(e){return[e,r.flattenItems(e.getChildren())]}).flattenDeep().value()},r.setActive=function(){r.resetActive();var e;e=r.onlyLeaves?l.find(r.itemsFlat,function(e){return e.isLeaf()&&e.isPresent()}):l.find(r.items,function(e){return e.isPresent()}),e&&e.setActive(!0)},this.$onInit=function(){r.shown=!1,r.properties={id:r.idProperty||"id",label:r.labelProperty||"label",children:r.childrenProperty||"children"},l.isUndefined(r.multiselect)&&(r.multiselect=!0),l.isUndefined(r.onlyLeaves)&&(r.onlyLeaves=!1),l.isUndefined(r.selectsChildren)&&(r.selectsChildren=!1),l.isUndefined(r.deselectsChildren)&&(r.deselectsChildren=!1),l.isUndefined(r.restrictModel)&&(r.restrictModel=!1),l.isUndefined(r.enablePills)&&(r.enablePills=!0),l.isUndefined(r.modelAsId)&&(r.modelAsId=!0),l.isNumber(r.filterAutoShowLength)||(r.filterAutoShowLength=2),l.isFunction(r.filterNode)||(r.filterNode=function(e,t){return l.includes(l.toLower(l.get(e,r.properties.label)),l.toLower(t))}),l.isFunction(r.disableNode)||(r.disableNode=l.stubFalse),l.isUndefined(r.disableClick)||(r.disableClick=!1),r.ngModel=e.controller("ngModel"),r.multiselect&&(r.ngModel.$isEmpty=l.isEmpty),this.registerWatches()},this.registerWatches=function(){t.$watch("vm.filterText",function(){r.setExclusions(r.items),l.size(r.filterText)>=r.filterAutoShowLength?(r.showAll(),r.setActive()):r.reset()}),t.$watchCollection("vm.ngModel.$modelValue",function(){r.syncModelToItems()}),t.$watch("vm.treeData",function(){l.forEach(r.itemsFlat,function(e,t){delete r.itemsFlat[t]}),r.items=r.createItems(r.treeData),r.itemsFlat=r.flattenItems(r.items),r.itemsIndex=l.keyBy(r.itemsFlat,function(e){return e.getId()}),r.syncModelToItems()}),t.$watch("vm.restrictModel",function(e){e&&r.syncModelToItems()}),t.$watch("vm.onlyLeaves",function(e){e&&r.clearBranches()}),t.$watch("vm.ngDisabled",function(e){e&&r.close()})}}n.$inject=["$element","$scope","$timeout","$window","TreeChooserItem"],e.exports=n},function(e,t){e.exports=require("lodash")},function(e,t,i){"use strict";e.exports=function(e){e.directive("treeChooserItem",i(12)).controller("treeChooserItemController",i(14)).factory("TreeChooserItem",i(15))}},function(e,t,i){"use strict";function n(){return{bindToController:!0,controller:"treeChooserItemController",controllerAs:"vm",require:"^treeChooser",scope:{item:"=treeChooserItem"},template:i(13)}}e.exports=n},function(e,t){e.exports='<span class=treeChooser-item ng-class="{\'treeChooser-selected\': vm.item.isSelected(), \'treeChooser-active\': vm.item.isActive()}"> <span class=treeChooser-expansion ng-click="vm.chooserVm.clearActive(); vm.item.setActive(true); vm.item.toggleExpanded()"> <span ng-show="vm.item.hasAChildPresent() && vm.item.isExpanded()" class=treeChooser-expanded>-</span> <span ng-show="vm.item.hasAChildPresent() && !vm.item.isExpanded()" class=treeChooser-collapsed>+</span> </span> <span class=treeChooser-label ng-class="{\'treeChooser-disabled\': vm.chooserVm.disableNode(vm.item)}" ng-click="vm.chooserVm.clearActive(); vm.item.setActive(true); vm.chooserVm.toggleSelected(vm.item)"> {{vm.item.getLabel()}} </span> <ul ng-if=vm.item.isExpanded()> <li ng-repeat="item in vm.item.getPresentChildren()" tree-chooser-item=item></li> </ul> </span> '},function(e,t){"use strict";function i(e){var t=this;t.chooserVm=e.controller("treeChooser")}i.$inject=["$element"],e.exports=i},function(e,t,i){"use strict";function n(){function e(i,n,o){var s=this;this.item=i,this.properties=o,this.id=t.get(this.item,this.properties.id),this.label=t.get(this.item,this.properties.label),this.parent=n,this.active=!1,this.excluded=!1,this.expanded=!1,this.selected=!1;var r=t.get(i,o.children);this.children=t.map(r,function(t){return new e(t,s,o)})}var t=i(10);return e.prototype.getItem=function(){return this.item},e.prototype.getChildren=function(){return this.children},e.prototype.hasAChildPresent=function(){return!!t.find(this.getChildren(),function(e){return e.isPresent()})},e.prototype.getPresentChildren=function(){return t.filter(this.getChildren(),function(e){return e.isPresent()})},e.prototype.getId=function(){return this.id},e.prototype.getLabel=function(){return this.label},e.prototype.isActive=function(){return this.active},e.prototype.isLeaf=function(){return t.isEmpty(this.children)},e.prototype.isShowing=function(){return this.isPresent()&&(!this.parent||this.parent.isExpanded())},e.prototype.isPresent=function(){return!this.excluded},e.prototype.isExpanded=function(){return this.expanded},e.prototype.isSelected=function(){return this.selected},e.prototype.setActive=function(e){this.active=e},e.prototype.setExcluded=function(e){this.excluded=e},e.prototype.setExpanded=function(e){this.expanded=e},e.prototype.setSelected=function(e){this.selected=e},e.prototype.toggleExpanded=function(){this.expanded=!this.expanded},e}e.exports=n}]);
//# sourceMappingURL=tree-chooser.min.js.map