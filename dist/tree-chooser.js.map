{"version":3,"sources":["webpack:///webpack/bootstrap bd925266cfa7943a9ead","webpack:///./src/index.js","webpack:///external \"angular\"","webpack:///./src/treeChooser/index.js","webpack:///./src/treeChooser/treeChooser.directive.js","webpack:///./src/treeChooser/treeChooser.css","webpack:///./src/treeChooser/treeChooser.html","webpack:///./src/treeChooser/treeChooser.controller.js","webpack:///external {\"commonjs\":\"lodash\"}","webpack:///./src/treeChooserItem/index.js","webpack:///./src/treeChooserItem/treeChooserItem.directive.js","webpack:///./src/treeChooserItem/treeChooserItem.html","webpack:///./src/treeChooserItem/treeChooserItem.controller.js","webpack:///./src/treeChooserItem/treeChooserItem.factory.js"],"names":["angular","require","treeChooser","module","exports","directive","controller","TreeChooser","$timeout","bindToController","controllerAs","scope","treeData","idProperty","labelProperty","childrenProperty","deselectsChildren","disableNode","filterNode","filterAutoShowLength","multiselect","ngDisabled","ngPlaceholder","onlyLeaves","restrictModel","selectsChildren","enablePills","modelAsId","disableClick","template","link","element","input","querySelector","on","event","stopPropagation","list","focusInput","focus","focusList","getListStyles","top","parentNode","offsetHeight","width","offsetWidth","scrollActive","active","scrollTop","offsetTop","TreeChooserController","$element","$scope","$window","TreeChooserItem","vm","_","show","shown","next","addEventListener","closeFromClick","tryShow","$event","includes","get","relatedTarget","close","filterText","reset","clearActive","removeEventListener","$apply","forEach","itemsFlat","item","setActive","setExpanded","onListKeyDown","shouldStop","keyCode","toggleSelectedActive","prev","collapseActive","expandActive","preventDefault","onTextKeyDown","isEmpty","ngModel","$viewValue","isNil","removeFromModel","findActive","first","find","isShowing","start","findIndex","isActive","index","last","findLast","isTab","isSelected","toggleSelected","setSelected","selectChildren","getPresentChildren","child","deselectChildren","getChildren","value","isLeaf","addToModel","getItem","getPresentItems","filter","items","isPresent","isMatch","setExclusions","parentMatched","setExcluded","hasAChildPresent","showAll","clearBranches","getModelAsItems","map","invoke","itemsIndex","compact","getId","push","$validate","$setViewValue","id","properties","remove","pop","syncModelToItems","debounce","model","$modelValue","toDelete","checkItem","createItems","flattenItems","flattenDeep","$onInit","label","children","isUndefined","isNumber","isFunction","toLower","stubFalse","$isEmpty","registerWatches","$watch","size","$watchCollection","keyBy","factory","TreeChooserItemController","chooserVm","TreeChooserItemFactory","parent","excluded","expanded","selected","prototype","getLabel","isExpanded","toggleExpanded"],"mappings":";;AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;;ACtCA,KAAIA,UAAU,mBAAAC,CAAQ,CAAR,CAAd;;AAEA,KAAIC,cAAcF,QAAQG,MAAR,CAAe,aAAf,EAA8B,EAA9B,CAAlB;;AAEA,oBAAAF,CAAQ,CAAR,EAAyBC,WAAzB;AACA,oBAAAD,CAAQ,EAAR,EAA6BC,WAA7B;;AAEAC,QAAOC,OAAP,GAAiBF,WAAjB,C;;;;;;ACPA,qC;;;;;;ACAA;;AAEAC,QAAOC,OAAP,GAAiB,UAAUF,WAAV,EAAuB;AACtCA,eACGG,SADH,CACa,aADb,EAC4B,mBAAAJ,CAAQ,CAAR,CAD5B,EAEGK,UAFH,CAEc,uBAFd,EAEuC,mBAAAL,CAAQ,CAAR,CAFvC;AAGD,EAJD,C;;;;;;ACFA;;;;;AAGA,UAASM,YAAYC,UAAU;GAC7B,mBAAAP,CAAQ;;GAER,IAAID,UAAU,mBAAAC,CAAQ;;GAEtB,OAAO;KACLQ,kBAAkB;KAClBH,YAAY;KACZI,cAAc;KACdT,SAAS,CAAC;KACVU,OAAO;;;;;OAKLC,UAAU;;;;;;OAMVC,YAAY;;;;;;;OAOZC,eAAe;;;;;;OAMfC,kBAAkB;;;;;;OAMlBC,mBAAmB;;;;;;OAMnBC,aAAa;;;;;;OAMbC,YAAY;;;;;;OAMZC,sBAAsB;;;;;;OAMtBC,aAAa;;;;;;OAMbC,YAAY;;;;;;OAMZC,eAAe;;;;;;OAMfC,YAAY;;;;;;OAMZC,eAAe;;;;;;OAMfC,iBAAiB;;;;;;OAMjBC,aAAa;;;;;;OAMbC,WAAW;;;;;;OAMXC,cAAc;;KAEhBC,UAAU,mBAAA5B,CAAQ;KAClB6B,MAAM,cAAUnB,OAAOoB,SAAS;OAC9B,IAAIC,QAAQhC,QAAQ+B,QAAQA,QAAQ,GAAGE,cAAc;OACrDD,MAAME,GAAG,SAAS,UAAUC,OAAO;SACjCA,MAAMC;;;OAGR,IAAIC,OAAOrC,QAAQ+B,QAAQA,QAAQ,GAAGE,cAAc;OACpDI,KAAKH,GAAG,SAAS,UAAUC,OAAO;SAChCA,MAAMC;;;OAGRzB,MAAM2B,aAAa,YAAY;SAC7B9B,SAAS,YAAY;WACnBwB,MAAM,GAAGO;;;;OAIb5B,MAAM6B,YAAY,YAAY;SAC5BhC,SAAS,YAAY;WACnB6B,KAAK,GAAGE;;;;OAIZ5B,MAAM8B,gBAAgB,YAAY;SAChC,OAAO;WACLC,KAAKV,MAAM,GAAGW,WAAWC,eAAe;WACxCC,OAAOb,MAAM,GAAGW,WAAWG,cAAc;;;;OAI7CnC,MAAMoC,eAAe,YAAY;SAC/BvC,SAAS,YAAY;WACnB,IAAIwC,SAASjB,QAAQ,GAAGE,cAAc;;WAEtC,IAAIe,QAAQ;aACVX,KAAK,GAAGY,YAAYD,OAAOE;;;;;;;;AAQvC/C,QAAOC,UAAUG,Y;;;;;;ACjKjB,0C;;;;;;;;;ACAA,oFAAmF,wCAAwC,mEAAmE,cAAc,iDAAiD,2BAA2B,4IAA4I,oBAAoB,gDAAgD,kBAAkB,+Q;;;;;;ACA1f;;;;;AAGA,UAAS4C,sBACPC,UACAC,QACAC,SACAC,iBACA;GACA,IAAIC,KAAK;OACPC,IAAI,mBAAAxD,CAAQ;;;;;;;GAOduD,GAAGE,OAAO,YAAY;KACpB,IAAIF,GAAGG,OAAO;OACZ;;;KAGFH,GAAGG,QAAQ;;KAEXH,GAAGI;;;KAGH,IAAI,CAACJ,GAAG5B,cAAc;OACpB0B,QAAQO,iBAAiB,SAASL,GAAGM;;;;;;;;GAQzCN,GAAGO,UAAU,UAAUC,QAAQ;KAC7B,IAAIP,EAAEQ,SAASR,EAAES,IAAIF,OAAOG,eAAe,cAAc,qBAAqB;OAC5E;;KAEFX,GAAGE;;;;;;GAMLF,GAAGY,QAAQ,YAAY;KACrBZ,GAAGa,aAAa;KAChBb,GAAGc;KACHd,GAAGG,QAAQ;KACXH,GAAGe;KACH,IAAI,CAACf,GAAG5B,cAAc;OACpB0B,QAAQkB,oBAAoB,SAAShB,GAAGM;;;;;;;GAO5CN,GAAGM,iBAAiB,YAAY;KAC9BN,GAAGY;KACHf,OAAOoB;;;;;;GAMTjB,GAAGc,QAAQ,YAAY;KACrBb,EAAEiB,QAAQlB,GAAGmB,WAAW,UAAUC,MAAM;OACtCA,KAAKC,UAAU;OACfD,KAAKE,YAAY;;;;;;;;GAQrBtB,GAAGuB,gBAAgB,UAAUf,QAAQ;KACnC,IAAIgB,aAAa;;KAEjB,QAAQhB,OAAOiB;OACb,KAAK;;SACHD,aAAa;SACbxB,GAAGY;SACHf,OAAOf;SACP;OACF,KAAK;;SACH0C,aAAa;SACbxB,GAAG0B;SACH1B,GAAGY;SACHf,OAAOf;SACP;OACF,KAAK;;SACH0C,aAAa;SACbxB,GAAGI;SACH;OACF,KAAK;;SACHoB,aAAa;SACbxB,GAAG2B;SACH;OACF,KAAK;;SACHH,aAAa;SACbxB,GAAG4B;SACH;OACF,KAAK;;SACHJ,aAAa;SACbxB,GAAG6B;SACH;OACF,KAAK;;SACHL,aAAa;SACbxB,GAAG0B;SACH;OACF,KAAK;;SACH1B,GAAG0B,qBAAqB;SACxB1B,GAAGY;SACH;;;KAGJ,IAAIY,YAAY;OACdhB,OAAOsB;OACPtB,OAAO5B;;;;;;;;GAQXoB,GAAG+B,gBAAgB,UAAUvB,QAAQ;KACnC,QAAQA,OAAOiB;OACb,KAAK;;SACHzB,GAAGY;SACH;OACF,KAAK;;SACH,IAAIZ,GAAGG,OAAO;WACZH,GAAG0B;gBACE;WACL1B,GAAGE,KAAKM;;SAEV;OACF,KAAK;;SACHR,GAAGE,KAAKM;SACRX,OAAOb;SACP;OACF,KAAK;;SACH,IAAIiB,EAAE+B,QAAQhC,GAAGa,gBAAgBb,GAAGpC,cAAc,CAACqC,EAAE+B,QAAQhC,GAAGiC,QAAQC,cAAc,CAACjC,EAAEkC,MAAMnC,GAAGiC,QAAQC,cAAc;WACtHlC,GAAGoC;;SAEL;OACF,KAAK;;SACHpC,GAAG0B,qBAAqB;SACxB1B,GAAGY;SACH;;;;;;;GAONZ,GAAGI,OAAO,YAAY;KACpB,IAAIH,EAAE+B,QAAQhC,GAAGmB,YAAY;OAC3B;;;KAGF,IAAI3B,SAASQ,GAAGqC;;KAEhB,IAAI,CAAC7C,QAAQ;OACX,IAAI8C,QAAQrC,EAAEsC,KAAKvC,GAAGmB,WAAW,UAAUC,MAAM;SAC/C,OAAOA,KAAKoB;;;OAGd,IAAIF,OAAO;SACTA,MAAMjB,UAAU;;YAEb;OACL,IAAIoB,QAAQxC,EAAEyC,UAAU1C,GAAGmB,WAAW,UAAUC,MAAM;SACpD,OAAOA,KAAKuB;;OAEdnD,OAAO6B,UAAU;;;OAGjB,IAAIjB,OAAOH,EAAEsC,KAAKvC,GAAGmB,WAAW,UAAUC,MAAMwB,OAAO;SACrD,OAAOA,QAAQH,SAASrB,KAAKoB;;OAE/B,IAAI,CAACpC,MAAM;SACTA,OAAOH,EAAEsC,KAAKvC,GAAGmB,WAAW,UAAUC,MAAMwB,OAAO;WACjD,OAAOA,QAAQH,SAASrB,KAAKoB;;;OAGjC,IAAIpC,MAAM;SACRA,KAAKiB,UAAU;;;;KAInBxB,OAAON;;;;;;GAMTS,GAAG2B,OAAO,YAAY;KACpB,IAAInC,SAASQ,GAAGqC;;KAEhB,IAAI,CAAC7C,QAAQ;OACX,IAAIqD,OAAO5C,EAAE6C,SAAS9C,GAAGmB,WAAW,UAAUC,MAAM;SAClD,OAAOA,KAAKoB;;;OAGd,IAAIK,MAAM;SACRA,KAAKxB,UAAU;;YAEZ;OACL,IAAIoB,QAAQxC,EAAEyC,UAAU1C,GAAGmB,WAAW,UAAUC,MAAM;SACpD,OAAOA,KAAKuB;;OAEdnD,OAAO6B,UAAU;;;OAGjB,IAAIM,OAAO1B,EAAE6C,SAAS9C,GAAGmB,WAAW,UAAUC,MAAMwB,OAAO;SACzD,OAAOA,QAAQH,SAASrB,KAAKoB;;OAE/B,IAAI,CAACb,MAAM;SACTA,OAAO1B,EAAE6C,SAAS9C,GAAGmB,WAAW,UAAUC,MAAMwB,OAAO;WACrD,OAAOA,QAAQH,SAASrB,KAAKoB;;;OAGjC,IAAIb,MAAM;SACRA,KAAKN,UAAU;;;;KAInBxB,OAAON;;;;;;GAMTS,GAAG6B,eAAe,YAAY;KAC5B,IAAIrC,SAASQ,GAAGqC;KAChB,IAAI7C,QAAQ;OACVA,OAAO8B,YAAY;;;;;;;GAOvBtB,GAAG4B,iBAAiB,YAAY;KAC9B,IAAIpC,SAASQ,GAAGqC;KAChB,IAAI7C,QAAQ;OACVA,OAAO8B,YAAY;;;;;;;GAOvBtB,GAAGe,cAAc,YAAY;KAC3Bd,EAAEiB,QAAQlB,GAAGmB,WAAW,UAAUC,MAAM;OACtCA,KAAKC,UAAU;;;;;;;;GAQnBrB,GAAG0B,uBAAuB,UAAUqB,OAAO;KACzC,IAAIvD,SAASQ,GAAGqC;KAChB,IAAI7C,QAAQ;;OAEV,IAAIuD,SAASvD,OAAOwD,cAAc;SAChC;;OAEFhD,GAAGiD,eAAezD;;;;;;;GAOtBQ,GAAGqC,aAAa,YAAY;KAC1B,OAAOpC,EAAEsC,KAAKvC,GAAGmB,WAAW,UAAUC,MAAM;OAC1C,OAAOA,KAAKuB;;;;;;;GAOhB3C,GAAGiD,iBAAiB,UAAU7B,MAAM;KAClC,IAAIpB,GAAGvC,YAAY2D,OAAO;OACxB;;;KAGFpB,GAAGkD,YAAY9B,MAAM,CAACA,KAAK4B;KAC3B,IAAI5B,KAAK4B,gBAAgB,CAAChD,GAAGpC,aAAa;OACxCoC,GAAGY;;;;;;;GAOPZ,GAAGmD,iBAAiB,UAAU/B,MAAM;KAClCnB,EAAEiB,QAAQE,KAAKgC,sBAAsB,UAAUC,OAAO;OACpD,IAAI,CAACA,MAAML,cAAc;SACvBhD,GAAGkD,YAAYG,OAAO;;OAExBrD,GAAGmD,eAAeE;;;;;;;GAOtBrD,GAAGsD,mBAAmB,UAAUlC,MAAM;KACpCnB,EAAEiB,QAAQE,KAAKmC,eAAe,UAAUF,OAAO;OAC7C,IAAIA,MAAML,cAAc;SACtBhD,GAAGkD,YAAYG,OAAO;;OAExBrD,GAAGsD,iBAAiBD;;;;;;;GAOxBrD,GAAGkD,cAAc,UAAU9B,MAAMoC,OAAO;;KAEtC,IAAIA,SAASxD,GAAGjC,cAAc,CAACqD,KAAKqC,UAAU;OAC5CD,QAAQ;;KAEVpC,KAAK8B,YAAYM;KACjB,IAAIA,OAAO;OACTxD,GAAG0D,WAAWtC;OACd,IAAIpB,GAAG/B,mBAAmB+B,GAAGpC,aAAa;SACxCoC,GAAGmD,eAAe/B;;YAEf;OACLpB,GAAGoC,gBAAgBhB,KAAKuC;OACxB,IAAI3D,GAAGxC,qBAAqBwC,GAAGpC,aAAa;SAC1CoC,GAAGsD,iBAAiBlC;;;;;;;;GAQ1BpB,GAAG4D,kBAAkB,YAAY;KAC/B,OAAO3D,EAAE4D,OAAO7D,GAAG8D,OAAO,UAAU1C,MAAM;OACxC,OAAOA,KAAK2C;;;;;;;;GAQhB/D,GAAGgE,UAAU,UAAU5C,MAAM;KAC3B,IAAI,CAACpB,GAAGa,YAAY;OAClB,OAAO;;KAET,OAAOb,GAAGtC,WAAW0D,KAAKuC,WAAW3D,GAAGa;;;;;;;;GAQ1Cb,GAAGiE,gBAAgB,UAAUH,OAAOI,eAAe;KACjDjE,EAAEiB,QAAQ4C,OAAO,UAAU1C,MAAM;OAC/BpB,GAAGiE,cAAc7C,KAAKmC,eAAeW,iBAAiBlE,GAAGgE,QAAQ5C;OACjEA,KAAK+C,YAAY,CAACnE,GAAGgE,QAAQ5C,SAAS,CAACA,KAAKgD,sBAAsB,CAACF;;;;;;;GAOvElE,GAAGqE,UAAU,YAAY;KACvBpE,EAAED,GAAGmB,WACF0C,OAAO,UAAUzC,MAAM;OACtB,OAAOA,KAAK2C;QAEb7C,QAAQ,UAAUE,MAAM;OACvBA,KAAKE,YAAY;;;KAGrBtB,GAAGE;;;;;;;GAOLF,GAAGsE,gBAAgB,YAAY;KAC7BrE,EAAEiB,QAAQlB,GAAGmB,WAAW,UAAUC,MAAM;OACtC,IAAI,CAACA,KAAKqC,YAAYrC,KAAK4B,cAAc;SACvChD,GAAGkD,YAAY9B,MAAM;;;;;;;;GAQ3BpB,GAAGuE,kBAAkB,YAAY;KAC/B,OAAOtE,EAAED,GAAGpC,cAAcoC,GAAGiC,QAAQC,aAAa,CAAClC,GAAGiC,QAAQC,aAC3DsC,IAAI,UAAUpD,MAAM;;OAEnB,OAAOpB,GAAG7B,YAAY8B,EAAEwE,OAAOzE,GAAG0E,WAAWtD,OAAO,aAAaA;QAElEuD,UACAnB;;;;;;GAMLxD,GAAG0D,aAAa,UAAUtC,MAAM;KAC9B,IAAIoC,QAAQxD,GAAG7B,YAAYiD,KAAKwD,UAAUxD,KAAKuC;KAC/C,IAAI3D,GAAGpC,aAAa;OAClBoC,GAAGiC,QAAQC,WAAW2C,KAAKrB;OAC3BxD,GAAGiC,QAAQ6C;YACN;OACL9E,GAAGiC,QAAQ8C,cAAcvB;;;;;;;GAO7BxD,GAAGoC,kBAAkB,UAAUhB,MAAM;KACnC,IAAI,CAACpB,GAAGpC,aAAa;OACnBoC,GAAGiC,QAAQ8C,cAAc;YACpB;OACL,IAAI3D,MAAM;SACR,IAAI4D,KAAK/E,EAAES,IAAIU,MAAMpB,GAAGiF,WAAWD;SACnC/E,EAAEiF,OAAOlF,GAAGiC,QAAQC,YAAY,UAAUd,MAAM;WAC9C,OAAOpB,GAAG7B,YAAYiD,SAAS4D,KAAK/E,EAAES,IAAIU,MAAMpB,GAAGiF,WAAWD,QAAQA;;cAEnE;SACLhF,GAAGiC,QAAQC,WAAWiD;;OAExBnF,GAAGiC,QAAQ6C;;;;;;;GAOf9E,GAAGoF,mBAAmBnF,EAAEoF,SAAS,YAAY;KAC3CpF,EAAEiB,QAAQlB,GAAGmB,WAAW,UAAUC,MAAM;OACtCA,KAAK8B,YAAY;;;KAGnB,IAAIoC,QAAQtF,GAAGpC,cAAcoC,GAAGiC,QAAQsD,cAAc,CAACvF,GAAGiC,QAAQsD;;KAElE,IAAIC,WAAW;;KAEfvF,EAAEiB,QAAQoE,OAAO,UAAUlE,MAAM;OAC/B,IAAI4D,KAAKhF,GAAG7B,YAAYiD,OAAOnB,EAAES,IAAIU,MAAMpB,GAAGiF,WAAWD;OACzD,IAAIS,YAAYzF,GAAG0E,WAAWM;OAC9B,IAAIS,WAAW;SACbA,UAAUvC,YAAY;cACjB,IAAIlD,GAAGhC,eAAe;SAC3BwH,SAASX,KAAKzD;;;;KAIlBnB,EAAEiB,QAAQsE,UAAU,UAAUpE,MAAM;OAClCpB,GAAGoC,gBAAgBhB;;;;KAIrBvB,OAAOoB;;;;;;GAMTjB,GAAG0F,cAAc,UAAU5B,OAAO;KAChC,OAAO7D,EAAEuE,IAAIV,OAAO,UAAU1C,MAAM;OAClC,OAAO,IAAIrB,gBAAgBqB,MAAM,MAAMpB,GAAGiF;;;;;;;GAO9CjF,GAAG2F,eAAe,UAAU7B,OAAO;KACjC,OAAO7D,EAAE6D,OACNU,IAAI,UAAUpD,MAAM;OACnB,OAAO,CAACA,MAAMpB,GAAG2F,aAAavE,KAAKmC;QAEpCqC,cACApC;;;;;;GAMLxD,GAAGqB,YAAY,YAAY;KACzB,IAAI7B,SAASQ,GAAGqC;KAChB,IAAI7C,UAAUA,OAAOuE,aAAa;;OAEhC;YACK,IAAIvE,QAAQ;OACjBA,OAAO6B,UAAU;;;KAGnB,IAAIiB;KACJ,IAAItC,GAAGjC,YAAY;;OAEjBuE,QAAQrC,EAAEsC,KAAKvC,GAAGmB,WAAW,UAAUC,MAAM;SAC3C,OAAOA,KAAKqC,YAAYrC,KAAK2C;;YAE1B;;OAELzB,QAAQrC,EAAEsC,KAAKvC,GAAG8D,OAAO,UAAU1C,MAAM;SACvC,OAAOA,KAAK2C;;;;KAIhB,IAAIzB,OAAO;OACTA,MAAMjB,UAAU;;;;GAIpB,KAAKwE,UAAU,YAAY;;KAEzB7F,GAAGG,QAAQ;;;KAGXH,GAAGiF,aAAa;OACdD,IAAIhF,GAAG3C,cAAc;OACrByI,OAAO9F,GAAG1C,iBAAiB;OAC3ByI,UAAU/F,GAAGzC,oBAAoB;;;;KAInC,IAAI0C,EAAE+F,YAAYhG,GAAGpC,cAAc;OACjCoC,GAAGpC,cAAc;;;KAGnB,IAAIqC,EAAE+F,YAAYhG,GAAGjC,aAAa;OAChCiC,GAAGjC,aAAa;;;KAGlB,IAAIkC,EAAE+F,YAAYhG,GAAG/B,kBAAkB;OACrC+B,GAAG/B,kBAAkB;;;KAGvB,IAAIgC,EAAE+F,YAAYhG,GAAGxC,oBAAoB;OACvCwC,GAAGxC,oBAAoB;;;KAGzB,IAAIyC,EAAE+F,YAAYhG,GAAGhC,gBAAgB;OACnCgC,GAAGhC,gBAAgB;;;KAGrB,IAAIiC,EAAE+F,YAAYhG,GAAG9B,cAAc;OACjC8B,GAAG9B,cAAc;;;KAGnB,IAAI+B,EAAE+F,YAAYhG,GAAG7B,YAAY;OAC/B6B,GAAG7B,YAAY;;;KAGjB,IAAI,CAAC8B,EAAEgG,SAASjG,GAAGrC,uBAAuB;OACxCqC,GAAGrC,uBAAuB;;;KAG5B,IAAI,CAACsC,EAAEiG,WAAWlG,GAAGtC,aAAa;OAChCsC,GAAGtC,aAAa,UAAU0D,MAAMP,YAAY;SAC1C,OAAOZ,EAAEQ,SAASR,EAAEkG,QAAQlG,EAAES,IAAIU,MAAMpB,GAAGiF,WAAWa,SAAS7F,EAAEkG,QAAQtF;;;;KAI7E,IAAI,CAACZ,EAAEiG,WAAWlG,GAAGvC,cAAc;OACjCuC,GAAGvC,cAAcwC,EAAEmG;;;KAGrB,IAAI,CAACnG,EAAE+F,YAAYhG,GAAG5B,eAAe;OACnC4B,GAAG5B,eAAe;;;;KAIpB4B,GAAGiC,UAAUrC,SAAS9C,WAAW;;KAEjC,IAAIkD,GAAGpC,aAAa;OAClBoC,GAAGiC,QAAQoE,WAAWpG,EAAE+B;;;KAG1B,KAAKsE;;;GAGP,KAAKA,kBAAkB,YAAY;;;;KAIjCzG,OAAO0G,OAAO,iBAAiB,YAAY;OACzCvG,GAAGiE,cAAcjE,GAAG8D;OACpB,IAAI7D,EAAEuG,KAAKxG,GAAGa,eAAeb,GAAGrC,sBAAsB;SACpDqC,GAAGqE;;OAELrE,GAAGqB;;;;;;KAMLxB,OAAO4G,iBAAiB,0BAA0B,YAAY;OAC5DzG,GAAGoF;;;;;;KAMLvF,OAAO0G,OAAO,eAAe,YAAY;;OAEvCtG,EAAEiB,QAAQlB,GAAGmB,WAAW,UAAUC,MAAMwB,OAAO;SAC7C,OAAO5C,GAAGmB,UAAUyB;;;;OAItB5C,GAAG8D,QAAQ9D,GAAG0F,YAAY1F,GAAG5C;;OAE7B4C,GAAGmB,YAAYnB,GAAG2F,aAAa3F,GAAG8D;;OAElC9D,GAAG0E,aAAazE,EAAEyG,MAAM1G,GAAGmB,WAAW,UAAUC,MAAM;SACpD,OAAOA,KAAKwD;;;OAGd5E,GAAGoF;;;;;;KAMLvF,OAAO0G,OAAO,oBAAoB,UAAU/C,OAAO;OACjD,IAAIA,OAAO;SACTxD,GAAGoF;;;;;;;KAOPvF,OAAO0G,OAAO,iBAAiB,UAAU/C,OAAO;OAC9C,IAAIA,OAAO;SACTxD,GAAGsE;;;;;;;KAOPzE,OAAO0G,OAAO,iBAAiB,UAAU/C,OAAO;OAC9C,IAAIA,OAAO;SACTxD,GAAGY;;;;;;AAMXjE,QAAOC,UAAU+C,sB;;;;;;AC9pBjB,oC;;;;;;ACAA;;AAEAhD,QAAOC,OAAP,GAAiB,UAAUF,WAAV,EAAuB;AACtCA,eACGG,SADH,CACa,iBADb,EACgC,mBAAAJ,CAAQ,EAAR,CADhC,EAEGK,UAFH,CAEc,2BAFd,EAE2C,mBAAAL,CAAQ,EAAR,CAF3C,EAGGkK,OAHH,CAGW,iBAHX,EAG8B,mBAAAlK,CAAQ,EAAR,CAH9B;AAID,EALD,C;;;;;;ACFA;;AAEA,UAASsD,eAAT,GAA2B;AACzB,UAAO;AACL9C,uBAAkB,IADb;AAELH,iBAAY,2BAFP;AAGLI,mBAAc,IAHT;AAILT,cAAS,cAJJ;AAKLU,YAAO;AACLiE,aAAM;AADD,MALF;AAQL/C,eAAU,mBAAA5B,CAAQ,EAAR;AARL,IAAP;AAUD;;AAEDE,QAAOC,OAAP,GAAiBmD,eAAjB,C;;;;;;ACfA,4DAA2D,uFAAuF,4EAA4E,yBAAyB,mSAAmS,0DAA0D,yCAAyC,yBAAyB,2CAA2C,oBAAoB,6I;;;;;;ACArtB;;;;;AAGA,UAAS6G,0BAA2BhH,UAAU;GAC5C,IAAII,KAAK;GACTA,GAAG6G,YAAYjH,SAAS9C,WAAW;;;AAGrCH,QAAOC,UAAUgK,0B;;;;;;ACRjB;;AAEA,UAASE,sBAAT,GAAmC;AACjC,OAAI7G,IAAI,mBAAAxD,CAAQ,EAAR,CAAR;;AAEA,YAASsD,eAAT,CAAyBqB,IAAzB,EAA+B2F,MAA/B,EAAuC9B,UAAvC,EAAmD;AAAA;;AACjD,UAAK7D,IAAL,GAAYA,IAAZ,CADiD,CAC/B;;AAElB,UAAK6D,UAAL,GAAkBA,UAAlB;AACA,UAAKD,EAAL,GAAU/E,EAAES,GAAF,CAAM,KAAKU,IAAX,EAAiB,KAAK6D,UAAL,CAAgBD,EAAjC,CAAV;AACA,UAAKc,KAAL,GAAa7F,EAAES,GAAF,CAAM,KAAKU,IAAX,EAAiB,KAAK6D,UAAL,CAAgBa,KAAjC,CAAb;;AAEA,UAAKiB,MAAL,GAAcA,MAAd;;AAEA,UAAKvH,MAAL,GAAc,KAAd;AACA,UAAKwH,QAAL,GAAgB,KAAhB;AACA,UAAKC,QAAL,GAAgB,KAAhB;AACA,UAAKC,QAAL,GAAgB,KAAhB;;AAEA,SAAInB,WAAW9F,EAAES,GAAF,CAAMU,IAAN,EAAY6D,WAAWc,QAAvB,CAAf;AACA,UAAKA,QAAL,GAAgB9F,EAAEuE,GAAF,CAAMuB,QAAN,EAAgB,UAAC1C,KAAD,EAAW;AACzC,cAAO,IAAItD,eAAJ,CAAoBsD,KAApB,SAAiC4B,UAAjC,CAAP;AACD,MAFe,CAAhB;AAGD;;AAEDlF,mBAAgBoH,SAAhB,CAA0BxD,OAA1B,GAAoC,YAAY;AAC9C,YAAO,KAAKvC,IAAZ;AACD,IAFD;;AAIArB,mBAAgBoH,SAAhB,CAA0B5D,WAA1B,GAAwC,YAAY;AAClD,YAAO,KAAKwC,QAAZ;AACD,IAFD;;AAIAhG,mBAAgBoH,SAAhB,CAA0B/C,gBAA1B,GAA6C,YAAY;AACvD,YAAO,CAAC,CAACnE,EAAEsC,IAAF,CAAO,KAAKgB,WAAL,EAAP,EAA2B,UAAUF,KAAV,EAAiB;AACnD,cAAOA,MAAMU,SAAN,EAAP;AACD,MAFQ,CAAT;AAGD,IAJD;;AAMAhE,mBAAgBoH,SAAhB,CAA0B/D,kBAA1B,GAA+C,YAAY;AACzD,YAAOnD,EAAE4D,MAAF,CAAS,KAAKN,WAAL,EAAT,EAA6B,UAAUF,KAAV,EAAiB;AACnD,cAAOA,MAAMU,SAAN,EAAP;AACD,MAFM,CAAP;AAGD,IAJD;;AAMAhE,mBAAgBoH,SAAhB,CAA0BvC,KAA1B,GAAkC,YAAY;AAC5C,YAAO,KAAKI,EAAZ;AACD,IAFD;;AAIAjF,mBAAgBoH,SAAhB,CAA0BC,QAA1B,GAAqC,YAAY;AAC/C,YAAO,KAAKtB,KAAZ;AACD,IAFD;;AAIA/F,mBAAgBoH,SAAhB,CAA0BxE,QAA1B,GAAqC,YAAY;AAC/C,YAAO,KAAKnD,MAAZ;AACD,IAFD;;AAIAO,mBAAgBoH,SAAhB,CAA0B1D,MAA1B,GAAmC,YAAY;AAC7C,YAAOxD,EAAE+B,OAAF,CAAU,KAAK+D,QAAf,CAAP;AACD,IAFD;;AAIAhG,mBAAgBoH,SAAhB,CAA0B3E,SAA1B,GAAsC,YAAY;AAChD,YAAO,KAAKuB,SAAL,OAAqB,CAAC,KAAKgD,MAAN,IAAgB,KAAKA,MAAL,CAAYM,UAAZ,EAArC,CAAP;AACD,IAFD;;AAIAtH,mBAAgBoH,SAAhB,CAA0BpD,SAA1B,GAAsC,YAAY;AAChD,YAAO,CAAC,KAAKiD,QAAb;AACD,IAFD;;AAIAjH,mBAAgBoH,SAAhB,CAA0BE,UAA1B,GAAuC,YAAY;AACjD,YAAO,KAAKJ,QAAZ;AACD,IAFD;;AAIAlH,mBAAgBoH,SAAhB,CAA0BnE,UAA1B,GAAuC,YAAY;AACjD,YAAO,KAAKkE,QAAZ;AACD,IAFD;;AAIAnH,mBAAgBoH,SAAhB,CAA0B9F,SAA1B,GAAsC,UAAUmC,KAAV,EAAiB;AACrD,UAAKhE,MAAL,GAAcgE,KAAd;AACD,IAFD;;AAIAzD,mBAAgBoH,SAAhB,CAA0BhD,WAA1B,GAAwC,UAAUX,KAAV,EAAiB;AACvD,UAAKwD,QAAL,GAAgBxD,KAAhB;AACD,IAFD;;AAIAzD,mBAAgBoH,SAAhB,CAA0B7F,WAA1B,GAAwC,UAAUkC,KAAV,EAAiB;AACvD,UAAKyD,QAAL,GAAgBzD,KAAhB;AACD,IAFD;;AAIAzD,mBAAgBoH,SAAhB,CAA0BjE,WAA1B,GAAwC,UAAUM,KAAV,EAAiB;AACvD,UAAK0D,QAAL,GAAgB1D,KAAhB;AACD,IAFD;;AAIAzD,mBAAgBoH,SAAhB,CAA0BG,cAA1B,GAA2C,YAAY;AACrD,UAAKL,QAAL,GAAgB,CAAC,KAAKA,QAAtB;AACD,IAFD;;AAIA,UAAOlH,eAAP;AACD;;AAEDpD,QAAOC,OAAP,GAAiBkK,sBAAjB,C","file":"tree-chooser.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap bd925266cfa7943a9ead","var angular = require('angular');\n\nvar treeChooser = angular.module('treeChooser', []);\n\nrequire('./treeChooser')(treeChooser);\nrequire('./treeChooserItem')(treeChooser);\n\nmodule.exports = treeChooser;\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","module.exports = require(\"angular\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"angular\"\n// module id = 1\n// module chunks = 0 1","'use strict';\n\nmodule.exports = function (treeChooser) {\n  treeChooser\n    .directive('treeChooser', require('./treeChooser.directive'))\n    .controller('treeChooserController', require('./treeChooser.controller'));\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/treeChooser/index.js","'use strict';\n\n/*@ngInject*/\nfunction TreeChooser($timeout) {\n  require('./treeChooser.css');\n\n  var angular = require('angular');\n\n  return {\n    bindToController: true,\n    controller: 'treeChooserController',\n    controllerAs: 'vm',\n    require: ['ngModel'],\n    scope: {\n      /**\n       * Tree data structure\n       * @type {Array.<Object>}\n       */\n      treeData: '=treeChooser',\n\n      /**\n       * Property that contains unique ID\n       * @type {string}\n       */\n      idProperty: '@',\n\n      /**\n       * Property that contains label\n       * @todo alternately support template\n       * @type {string}\n       */\n      labelProperty: '@',\n\n      /**\n       * Property that contains children array\n       * @type {string}\n       */\n      childrenProperty: '@',\n\n      /**\n       * Deselect all descendants\n       * @type {boolean}\n       */\n      deselectsChildren: '=?',\n\n      /**\n       * Function to determine if item is disabled\n       * @type {Function}\n       */\n      disableNode: '=?',\n\n      /**\n       * Function to determine if item is filtered\n       * @type {Function}\n       */\n      filterNode: '=?',\n\n      /**\n       * Show list and expand all nodes after specified length\n       * @type {number}\n       */\n      filterAutoShowLength: '=?',\n\n      /**\n       * Enable multiselection\n       * @type {boolean}\n       */\n      multiselect: '=?',\n\n      /**\n       * ngDisabled pass through\n       * @type {boolean}\n       */\n      ngDisabled: '=?',\n\n      /**\n       * ngPlaceholder pass through\n       * @type {boolean}\n       */\n      ngPlaceholder: '=?',\n\n      /**\n       * Only allow selection of leaf nodes\n       * @type {boolean}\n       */\n      onlyLeaves: '=?',\n\n      /**\n       * Restrict model to members of tree data structure\n       * @type {boolean}\n       */\n      restrictModel: '=?',\n\n      /**\n       * Select all descendants\n       * @type {boolean}\n       */\n      selectsChildren: '=?',\n\n      /**\n       * Enable pills\n       * @type {boolean}\n       */\n      enablePills: '=?',\n\n      /**\n       * Just use the ID as the model value?\n       * @type {boolean}\n       */\n      modelAsId: '=?',\n\n      /**\n       * Disable outside click to close\n       * @type {boolean}\n       */\n      disableClick: '=?'\n    },\n    template: require('./treeChooser.html'),\n    link: function (scope, element) {\n      var input = angular.element(element[0].querySelector('.treeChooser-input input'));\n      input.on('click', function (event) {\n        event.stopPropagation();\n      });\n\n      var list = angular.element(element[0].querySelector('.treeChooser-list'));\n      list.on('click', function (event) {\n        event.stopPropagation();\n      });\n\n      scope.focusInput = function () {\n        $timeout(function () {\n          input[0].focus();\n        });\n      };\n\n      scope.focusList = function () {\n        $timeout(function () {\n          list[0].focus();\n        });\n      };\n\n      scope.getListStyles = function () {\n        return {\n          top: input[0].parentNode.offsetHeight + 'px',\n          width: input[0].parentNode.offsetWidth + 'px'\n        };\n      };\n\n      scope.scrollActive = function () {\n        $timeout(function () {\n          var active = element[0].querySelector('.treeChooser-active .treeChooser-label');\n          // If no results are shown, there won't be an active!\n          if (active) {\n            list[0].scrollTop = active.offsetTop;\n          }\n        });\n      };\n    }\n  };\n}\n\nmodule.exports = TreeChooser;\n\n\n\n// WEBPACK FOOTER //\n// ./src/treeChooser/treeChooser.directive.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/treeChooser/treeChooser.css\n// module id = 4\n// module chunks = 0 1","module.exports = \"<div class=treeChooser> <div class=treeChooser-input ng-class=\\\"{'treeChooser-input-focused': vm.focused}\\\"> <span ng-if=vm.enablePills ng-click=\\\"vm.removeFromModel(item); focusInput();\\\" ng-repeat=\\\"item in vm.getModelAsItems()\\\"> {{item[vm.properties.label]}} </span> <input type=text ng-disabled=vm.ngDisabled ng-model=vm.filterText ng-keydown=vm.onTextKeyDown($event) ng-focus=\\\"vm.focused = true; vm.tryShow($event);\\\" ng-blur=\\\"vm.focused = false\\\" placeholder={{vm.ngPlaceholder}}> </div> <ul ng-show=vm.shown ng-keydown=vm.onListKeyDown($event) ng-style=getListStyles() class=treeChooser-list tabindex=-1> <li ng-repeat=\\\"item in vm.getPresentItems()\\\" tree-chooser-item=item></li> <li ng-if=!vm.getPresentItems().length>No match</li> </ul> </div> \";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/treeChooser/treeChooser.html\n// module id = 8\n// module chunks = 0 1","'use strict';\n\n/*@ngInject*/\nfunction TreeChooserController(\n  $element,\n  $scope,\n  $window,\n  TreeChooserItem\n) {\n  var vm = this,\n    _ = require('lodash');\n\n  // @todo create a separate directive for the list\n\n  /**\n   * Show the search results, add outside click handler\n   */\n  vm.show = function () {\n    if (vm.shown) {\n      return;\n    }\n\n    vm.shown = true;\n\n    vm.next();\n\n    // Add event listener to determine when user clicks outside of tree chooser\n    if (!vm.disableClick) {\n      $window.addEventListener('click', vm.closeFromClick);\n    }\n  };\n\n  /**\n   * Show on focus, unless returning from the list\n   * @param {Event} $event\n   */\n  vm.tryShow = function ($event) {\n    if (_.includes(_.get($event.relatedTarget, 'className'), 'treeChooser-list')) {\n      return;\n    }\n    vm.show();\n  };\n\n  /**\n   * Close the search results, remove outside click handler\n   */\n  vm.close = function () {\n    vm.filterText = '';\n    vm.reset();\n    vm.shown = false;\n    vm.clearActive();\n    if (!vm.disableClick) {\n      $window.removeEventListener('click', vm.closeFromClick);\n    }\n  };\n\n  /**\n   * Close on outside click\n   */\n  vm.closeFromClick = function () {\n    vm.close();\n    $scope.$apply();\n  };\n\n  /**\n   * Reset the collapsed and active state\n   */\n  vm.reset = function () {\n    _.forEach(vm.itemsFlat, function (item) {\n      item.setActive(false);\n      item.setExpanded(false);\n    });\n  };\n\n  /**\n   * Handle results keyboard navigation\n   * @param {Object} $event\n   */\n  vm.onListKeyDown = function ($event) {\n    var shouldStop = false;\n\n    switch ($event.keyCode) {\n      case 27: //Escape\n        shouldStop = true;\n        vm.close();\n        $scope.focusInput();\n        break;\n      case 13: //Enter\n        shouldStop = true;\n        vm.toggleSelectedActive();\n        vm.close();\n        $scope.focusInput();\n        break;\n      case 40: //Down Arrow\n        shouldStop = true;\n        vm.next();\n        break;\n      case 38: //Up Arrow\n        shouldStop = true;\n        vm.prev();\n        break;\n      case 37: //Left Arrow\n        shouldStop = true;\n        vm.collapseActive();\n        break;\n      case 39: //Right Arrow\n        shouldStop = true;\n        vm.expandActive();\n        break;\n      case 32: //Space\n        shouldStop = true;\n        vm.toggleSelectedActive();\n        break;\n      case 9: //Tab\n        vm.toggleSelectedActive(true);\n        vm.close();\n        break;\n    }\n\n    if (shouldStop) {\n      $event.preventDefault();\n      $event.stopPropagation();\n    }\n  };\n\n  /**\n   * Handle input keyboard navigation\n   * @param {Object} $event\n   */\n  vm.onTextKeyDown = function ($event) {\n    switch ($event.keyCode) {\n      case 27: //Escape\n        vm.close();\n        break;\n      case 13: //Enter\n        if (vm.shown) {\n          vm.toggleSelectedActive();\n        } else {\n          vm.show($event);\n        }\n        break;\n      case 40: //Down Arrow\n        vm.show($event);\n        $scope.focusList();\n        break;\n      case 8: //Backspace\n        if (_.isEmpty(vm.filterText) && (vm.multiselect ? !_.isEmpty(vm.ngModel.$viewValue) : !_.isNil(vm.ngModel.$viewValue))) {\n          vm.removeFromModel();\n        }\n        break;\n      case 9: //Tab\n        vm.toggleSelectedActive(true);\n        vm.close();\n        break;\n    }\n  };\n\n  /**\n   * Find next visible item\n   */\n  vm.next = function () {\n    if (_.isEmpty(vm.itemsFlat)) {\n      return;\n    }\n\n    var active = vm.findActive();\n\n    if (!active) {\n      var first = _.find(vm.itemsFlat, function (item) {\n        return item.isShowing();\n      });\n      // If no results are shown, there's nothing to set first!\n      if (first) {\n        first.setActive(true);\n      }\n    } else {\n      var start = _.findIndex(vm.itemsFlat, function (item) {\n        return item.isActive();\n      });\n      active.setActive(false);\n\n      // @todo optimize array traversal\n      var next = _.find(vm.itemsFlat, function (item, index) {\n        return index > start && item.isShowing();\n      });\n      if (!next) {\n        next = _.find(vm.itemsFlat, function (item, index) {\n          return index < start && item.isShowing();\n        });\n      }\n      if (next) {\n        next.setActive(true);\n      }\n    }\n\n    $scope.scrollActive();\n  };\n\n  /**\n   * Find previous visible item\n   */\n  vm.prev = function () {\n    var active = vm.findActive();\n\n    if (!active) {\n      var last = _.findLast(vm.itemsFlat, function (item) {\n        return item.isShowing();\n      });\n      // If no results are shown, there's nothing to set last!\n      if (last) {\n        last.setActive(true);\n      }\n    } else {\n      var start = _.findIndex(vm.itemsFlat, function (item) {\n        return item.isActive();\n      });\n      active.setActive(false);\n\n      // @todo optimize array traversal\n      var prev = _.findLast(vm.itemsFlat, function (item, index) {\n        return index < start && item.isShowing();\n      });\n      if (!prev) {\n        prev = _.findLast(vm.itemsFlat, function (item, index) {\n          return index > start && item.isShowing();\n        });\n      }\n      if (prev) {\n        prev.setActive(true);\n      }\n    }\n\n    $scope.scrollActive();\n  };\n\n  /**\n   * Expand active item\n   */\n  vm.expandActive = function () {\n    var active = vm.findActive();\n    if (active) {\n      active.setExpanded(true);\n    }\n  };\n\n  /**\n   * Collapse active item\n   */\n  vm.collapseActive = function () {\n    var active = vm.findActive();\n    if (active) {\n      active.setExpanded(false);\n    }\n  };\n\n  /**\n   * Set all items inactive\n   */\n  vm.clearActive = function () {\n    _.forEach(vm.itemsFlat, function (item) {\n      item.setActive(false);\n    });\n  };\n\n  /**\n   * Toggle selection on active item\n   * @param {boolean} [isTab]\n   */\n  vm.toggleSelectedActive = function (isTab) {\n    var active = vm.findActive();\n    if (active) {\n      // Don't unselect on tab\n      if (isTab && active.isSelected()) {\n        return;\n      }\n      vm.toggleSelected(active);\n    }\n  };\n\n  /**\n   * Get the active item\n   */\n  vm.findActive = function () {\n    return _.find(vm.itemsFlat, function (item) {\n      return item.isActive();\n    });\n  };\n\n  /**\n   * Toggle selected unless disabled\n   */\n  vm.toggleSelected = function (item) {\n    if (vm.disableNode(item)) {\n      return;\n    }\n\n    vm.setSelected(item, !item.isSelected());\n    if (item.isSelected() && !vm.multiselect) {\n      vm.close();\n    }\n  };\n\n  /**\n   * Select all unfiltered children\n   */\n  vm.selectChildren = function (item) {\n    _.forEach(item.getPresentChildren(), function (child) {\n      if (!child.isSelected()) {\n        vm.setSelected(child, true);\n      }\n      vm.selectChildren(child);\n    });\n  };\n\n  /**\n   * Deselect all children\n   */\n  vm.deselectChildren = function (item) {\n    _.forEach(item.getChildren(), function (child) {\n      if (child.isSelected()) {\n        vm.setSelected(child, false);\n      }\n      vm.deselectChildren(child);\n    });\n  };\n\n  /**\n   * Set selection state\n   */\n  vm.setSelected = function (item, value) {\n    // Enforce leaf only restrictions if necessary\n    if (value && vm.onlyLeaves && !item.isLeaf()) {\n      value = false;\n    }\n    item.setSelected(value);\n    if (value) {\n      vm.addToModel(item);\n      if (vm.selectsChildren && vm.multiselect) {\n        vm.selectChildren(item);\n      }\n    } else {\n      vm.removeFromModel(item.getItem());\n      if (vm.deselectsChildren && vm.multiselect) {\n        vm.deselectChildren(item);\n      }\n    }\n  };\n\n  /**\n   * Get top level present items\n   */\n  vm.getPresentItems = function () {\n    return _.filter(vm.items, function (item) {\n      return item.isPresent();\n    });\n  };\n\n  /**\n   * Determine if visible or not\n   * @todo isMatch, isPresent, isExcluded, etc all needs to better naming\n   */\n  vm.isMatch = function (item) {\n    if (!vm.filterText) {\n      return true;\n    }\n    return vm.filterNode(item.getItem(), vm.filterText);\n  };\n\n  /**\n   * Recursively set exclusions so that parents of included children aren't hidden\n   * @param {Array} items\n   * @param {boolean} parentMatched\n   */\n  vm.setExclusions = function (items, parentMatched) {\n    _.forEach(items, function (item) {\n      vm.setExclusions(item.getChildren(), parentMatched || vm.isMatch(item));\n      item.setExcluded(!vm.isMatch(item) && !item.hasAChildPresent() && !parentMatched);\n    });\n  };\n\n  /**\n   * Recursively set exclusions so that parents of included children aren't hidden\n   */\n  vm.showAll = function () {\n    _(vm.itemsFlat)\n      .filter(function (item) {\n        return item.isPresent();\n      })\n      .forEach(function (item) {\n        item.setExpanded(true);\n      });\n\n    vm.show();\n  };\n\n  /**\n   * Clear all no leaves\n   * @todo if deselect Children is enabled, won't this deselect leaves?\n   */\n  vm.clearBranches = function () {\n    _.forEach(vm.itemsFlat, function (item) {\n      if (!item.isLeaf() && item.isSelected()) {\n        vm.setSelected(item, false);\n      }\n    });\n  };\n\n  /**\n   * Get model as items because it could be ssaved as id\n   */\n  vm.getModelAsItems = function () {\n    return _(vm.multiselect ? vm.ngModel.$viewValue : [vm.ngModel.$viewValue])\n      .map(function (item) {\n        // Can' guarantee the item still exists unless restrict model is on\n        return vm.modelAsId ? _.invoke(vm.itemsIndex[item], 'getItem') : item;\n      })\n      .compact()\n      .value();\n  };\n\n  /**\n   * Add item to model and trigger validation\n   */\n  vm.addToModel = function (item) {\n    var value = vm.modelAsId ? item.getId() : item.getItem();\n    if (vm.multiselect) {\n      vm.ngModel.$viewValue.push(value);\n      vm.ngModel.$validate();\n    } else {\n      vm.ngModel.$setViewValue(value);\n    }\n  };\n\n  /**\n   * Remove item from model and trigger validation\n   */\n  vm.removeFromModel = function (item) {\n    if (!vm.multiselect) {\n      vm.ngModel.$setViewValue(null);\n    } else {\n      if (item) {\n        var id = _.get(item, vm.properties.id);\n        _.remove(vm.ngModel.$viewValue, function (item) {\n          return vm.modelAsId ? item === id : _.get(item, vm.properties.id) === id;\n        });\n      } else {\n        vm.ngModel.$viewValue.pop();\n      }\n      vm.ngModel.$validate();\n    }\n  };\n\n  /**\n   * Sync model to items in case model, items or restrictModel changes\n   */\n  vm.syncModelToItems = _.debounce(function () {\n    _.forEach(vm.itemsFlat, function (item) {\n      item.setSelected(false);\n    });\n\n    var model = vm.multiselect ? vm.ngModel.$modelValue : [vm.ngModel.$modelValue];\n\n    var toDelete = [];\n    // Set selected items back to true\n    _.forEach(model, function (item) {\n      var id = vm.modelAsId ? item : _.get(item, vm.properties.id);\n      var checkItem = vm.itemsIndex[id];\n      if (checkItem) {\n        checkItem.setSelected(true);\n      } else if (vm.restrictModel) {\n        toDelete.push(item);\n      }\n    });\n\n    _.forEach(toDelete, function (item) {\n      vm.removeFromModel(item);\n    });\n\n    // This is debounced, so ensure scope is applied!\n    $scope.$apply();\n  });\n\n  /**\n   * Create TreeChooserItem hierarchy\n   */\n  vm.createItems = function (items) {\n    return _.map(items, function (item) {\n      return new TreeChooserItem(item, null, vm.properties);\n    });\n  };\n\n  /**\n   * Flatten hierarchy for more efficient processing\n   */\n  vm.flattenItems = function (items) {\n    return _(items)\n      .map(function (item) {\n        return [item, vm.flattenItems(item.getChildren())];\n      })\n      .flattenDeep()\n      .value();\n  };\n\n  /**\n   * Set the active element on search\n   */\n  vm.setActive = function () {\n    var active = vm.findActive();\n    if (active && active.isPresent()) {\n      // If currently active item is still present, don't do anything\n      return;\n    } else if (active) {\n      active.setActive(false);\n    }\n\n    var first;\n    if (vm.onlyLeaves) {\n      // Find first present leaf in flat items\n      first = _.find(vm.itemsFlat, function (item) {\n        return item.isLeaf() && item.isPresent();\n      });\n    } else {\n      // Find first present branch, at least one branch will be present in items\n      first = _.find(vm.items, function (item) {\n        return item.isPresent();\n      });\n    }\n\n    if (first) {\n      first.setActive(true);\n    }\n  };\n\n  this.$onInit = function () {\n    // Flag to determine whether search results are showing\n    vm.shown = false;\n\n    // Properties use to access special parts of item\n    vm.properties = {\n      id: vm.idProperty || 'id',\n      label: vm.labelProperty || 'label',\n      children: vm.childrenProperty || 'children'\n    };\n\n    // Enable multiselect by default\n    if (_.isUndefined(vm.multiselect)) {\n      vm.multiselect = true;\n    }\n    // Disable only leaves by default\n    if (_.isUndefined(vm.onlyLeaves)) {\n      vm.onlyLeaves = false;\n    }\n    // Disable selects children by default\n    if (_.isUndefined(vm.selectsChildren)) {\n      vm.selectsChildren = false;\n    }\n    // Disable deselects children by default\n    if (_.isUndefined(vm.deselectsChildren)) {\n      vm.deselectsChildren = false;\n    }\n    // Disable restrict model by default\n    if (_.isUndefined(vm.restrictModel)) {\n      vm.restrictModel = false;\n    }\n    // Enable pills by default\n    if (_.isUndefined(vm.enablePills)) {\n      vm.enablePills = true;\n    }\n    // Save ID to model by default\n    if (_.isUndefined(vm.modelAsId)) {\n      vm.modelAsId = true;\n    }\n    // Auto show after specified filter text length\n    if (!_.isNumber(vm.filterAutoShowLength)) {\n      vm.filterAutoShowLength = 2;\n    }\n    // Default filter node function\n    if (!_.isFunction(vm.filterNode)) {\n      vm.filterNode = function (item, filterText) {\n        return _.includes(_.toLower(_.get(item, vm.properties.label)), _.toLower(filterText));\n      };\n    }\n    // Default disable node function\n    if (!_.isFunction(vm.disableNode)) {\n      vm.disableNode = _.stubFalse;\n    }\n    // Default to enable close to click\n    if (!_.isUndefined(vm.disableClick)) {\n      vm.disableClick = false;\n    }\n\n    // Get access to ngModel\n    vm.ngModel = $element.controller('ngModel');\n    // And override $isEmpty to account for array emptiness if multiselect\n    if (vm.multiselect) {\n      vm.ngModel.$isEmpty = _.isEmpty;\n    }\n\n    this.registerWatches();\n  };\n\n  this.registerWatches = function () {\n    /**\n     * Update exclusions on filter text change\n     */\n    $scope.$watch('vm.filterText', function () {\n      vm.setExclusions(vm.items);\n      if (_.size(vm.filterText) >= vm.filterAutoShowLength) {\n        vm.showAll();\n      }\n      vm.setActive();\n    });\n\n    /**\n     * Sync on model change\n     */\n    $scope.$watchCollection('vm.ngModel.$modelValue', function () {\n      vm.syncModelToItems();\n    });\n\n    /**\n     * Sync on items change\n     */\n    $scope.$watch('vm.treeData', function () {\n      // @todo is this manual GC needed?\n      _.forEach(vm.itemsFlat, function (item, index) {\n        delete vm.itemsFlat[index];\n      });\n\n      // Create chooser items, so the underlying model is not touched\n      vm.items = vm.createItems(vm.treeData);\n      // Flatten into a sorted list for easier navigation\n      vm.itemsFlat = vm.flattenItems(vm.items);\n      // Item index\n      vm.itemsIndex = _.keyBy(vm.itemsFlat, function (item) {\n        return item.getId();\n      });\n\n      vm.syncModelToItems();\n    });\n\n    /**\n     * Sync on restrict model\n     */\n    $scope.$watch('vm.restrictModel', function (value) {\n      if (value) {\n        vm.syncModelToItems();\n      }\n    });\n\n    /**\n     * Deselect branches on only leaves true\n     */\n    $scope.$watch('vm.onlyLeaves', function (value) {\n      if (value) {\n        vm.clearBranches();\n      }\n    });\n\n    /**\n     * Disable results on disable\n     */\n    $scope.$watch('vm.ngDisabled', function (value) {\n      if (value) {\n        vm.close();\n      }\n    });\n  };\n}\n\nmodule.exports = TreeChooserController;\n\n\n\n// WEBPACK FOOTER //\n// ./src/treeChooser/treeChooser.controller.js","module.exports = require(\"lodash\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"lodash\"}\n// module id = 10\n// module chunks = 0 1","'use strict';\n\nmodule.exports = function (treeChooser) {\n  treeChooser\n    .directive('treeChooserItem', require('./treeChooserItem.directive'))\n    .controller('treeChooserItemController', require('./treeChooserItem.controller'))\n    .factory('TreeChooserItem', require('./treeChooserItem.factory'));\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/treeChooserItem/index.js","'use strict';\n\nfunction TreeChooserItem() {\n  return {\n    bindToController: true,\n    controller: 'treeChooserItemController',\n    controllerAs: 'vm',\n    require: '^treeChooser',\n    scope: {\n      item: '=treeChooserItem'\n    },\n    template: require('./treeChooserItem.html'),\n  };\n}\n\nmodule.exports = TreeChooserItem;\n\n\n\n// WEBPACK FOOTER //\n// ./src/treeChooserItem/treeChooserItem.directive.js","module.exports = \"<span class=treeChooser-item ng-class=\\\"{'treeChooser-selected': vm.item.isSelected(), 'treeChooser-active': vm.item.isActive()}\\\"> <span class=treeChooser-expansion ng-click=\\\"vm.chooserVm.clearActive(); vm.item.setActive(true); vm.item.toggleExpanded()\\\"> <span ng-show=\\\"vm.item.hasAChildPresent() && vm.item.isExpanded()\\\" class=treeChooser-expanded>-</span> <span ng-show=\\\"vm.item.hasAChildPresent() && !vm.item.isExpanded()\\\" class=treeChooser-collapsed>+</span> </span> <span class=treeChooser-label ng-class=\\\"{'treeChooser-disabled': vm.chooserVm.disableNode(vm.item)}\\\" ng-click=\\\"vm.chooserVm.clearActive(); vm.item.setActive(true); vm.chooserVm.toggleSelected(vm.item)\\\"> {{vm.item.getLabel()}} </span> <ul ng-if=vm.item.isExpanded()> <li ng-repeat=\\\"item in vm.item.getPresentChildren()\\\" tree-chooser-item=item></li> </ul> </span> \";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/treeChooserItem/treeChooserItem.html\n// module id = 13\n// module chunks = 0 1","'use strict';\n\n/*@ngInject*/\nfunction TreeChooserItemController ($element) {\n  var vm = this;\n  vm.chooserVm = $element.controller('treeChooser');\n}\n\nmodule.exports = TreeChooserItemController;\n\n\n\n// WEBPACK FOOTER //\n// ./src/treeChooserItem/treeChooserItem.controller.js","'use strict';\n\nfunction TreeChooserItemFactory () {\n  var _ = require('lodash');\n\n  function TreeChooserItem(item, parent, properties) {\n    this.item = item; // @todo use this for templates\n\n    this.properties = properties;\n    this.id = _.get(this.item, this.properties.id);\n    this.label = _.get(this.item, this.properties.label);\n\n    this.parent = parent;\n\n    this.active = false;\n    this.excluded = false;\n    this.expanded = false;\n    this.selected = false;\n\n    var children = _.get(item, properties.children);\n    this.children = _.map(children, (child) => {\n      return new TreeChooserItem(child, this, properties);\n    });\n  }\n\n  TreeChooserItem.prototype.getItem = function () {\n    return this.item;\n  };\n\n  TreeChooserItem.prototype.getChildren = function () {\n    return this.children;\n  };\n\n  TreeChooserItem.prototype.hasAChildPresent = function () {\n    return !!_.find(this.getChildren(), function (child) {\n      return child.isPresent();\n    });\n  };\n\n  TreeChooserItem.prototype.getPresentChildren = function () {\n    return _.filter(this.getChildren(), function (child) {\n      return child.isPresent();\n    });\n  };\n\n  TreeChooserItem.prototype.getId = function () {\n    return this.id;\n  };\n\n  TreeChooserItem.prototype.getLabel = function () {\n    return this.label;\n  };\n\n  TreeChooserItem.prototype.isActive = function () {\n    return this.active;\n  };\n\n  TreeChooserItem.prototype.isLeaf = function () {\n    return _.isEmpty(this.children);\n  };\n\n  TreeChooserItem.prototype.isShowing = function () {\n    return this.isPresent() && (!this.parent || this.parent.isExpanded());\n  };\n\n  TreeChooserItem.prototype.isPresent = function () {\n    return !this.excluded;\n  };\n\n  TreeChooserItem.prototype.isExpanded = function () {\n    return this.expanded;\n  };\n\n  TreeChooserItem.prototype.isSelected = function () {\n    return this.selected;\n  };\n\n  TreeChooserItem.prototype.setActive = function (value) {\n    this.active = value;\n  };\n\n  TreeChooserItem.prototype.setExcluded = function (value) {\n    this.excluded = value;\n  };\n\n  TreeChooserItem.prototype.setExpanded = function (value) {\n    this.expanded = value;\n  };\n\n  TreeChooserItem.prototype.setSelected = function (value) {\n    this.selected = value;\n  };\n\n  TreeChooserItem.prototype.toggleExpanded = function () {\n    this.expanded = !this.expanded;\n  };\n\n  return TreeChooserItem;\n}\n\nmodule.exports = TreeChooserItemFactory;\n\n\n\n// WEBPACK FOOTER //\n// ./src/treeChooserItem/treeChooserItem.factory.js"],"sourceRoot":""}